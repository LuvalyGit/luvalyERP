/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package PanelForm;

import Conexion.ExeSql;
import Dialogos.jdBuscarCliPrv;
import Dialogos.jdPagadoPrvCli;
import Dialogos.jdPagarPrv;
import Formularios.fmMain;
import static Formularios.fmMain.pnPestanas;
import Utilidades.Exporter;
import Utilidades.PanelTab;
import java.awt.event.KeyEvent;
import java.io.File;
import java.math.BigInteger;
import java.sql.ResultSet;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.List;
import javax.swing.JFileChooser;
import javax.swing.JTable;
import javax.swing.SwingConstants;
import javax.swing.filechooser.FileNameExtensionFilter;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.DefaultTableModel;
import java.util.*;
import javax.swing.DefaultComboBoxModel;
import Utilidades.ComboCodigos;


/**
 *
 * @author David Alcaman
 */
public class pfRepProvConv_CompraVta extends javax.swing.JPanel {
    DefaultTableCellRenderer rightRenderer = new DefaultTableCellRenderer();
    /**
     * Creates new form pfReportePagosPrv
     */
    int id_proveedor, id_convenio;
    public pfRepProvConv_CompraVta() {
        initComponents();
        CargaProveedor();
        CargaConvenio();
        
        rb_venta.setSelected(true);
        
        // Formatea grilla alineando los numeros al lado derecho.
          rightRenderer.setHorizontalAlignment(SwingConstants.RIGHT);
        Grilla.getColumnModel().getColumn(7).setCellRenderer(rightRenderer);
        Grilla.getColumnModel().getColumn(8).setCellRenderer(rightRenderer);
        Grilla.getColumnModel().getColumn(9).setCellRenderer(rightRenderer);
        Grilla.getColumnModel().getColumn(10).setCellRenderer(rightRenderer);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jXDatePicker1 = new org.jdesktop.swingx.JXDatePicker();
        buttonGroup1 = new javax.swing.ButtonGroup();
        jPanel3 = new javax.swing.JPanel();
        CboProveedor = new javax.swing.JComboBox<>();
        lblVendedor = new javax.swing.JLabel();
        lblVendedor1 = new javax.swing.JLabel();
        CboConvenio = new javax.swing.JComboBox<>();
        jLabel2 = new javax.swing.JLabel();
        lblRut = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        lblCodConv = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        Grilla = new javax.swing.JTable();
        jPanel1 = new javax.swing.JPanel();
        rb_compra = new javax.swing.JRadioButton();
        rb_venta = new javax.swing.JRadioButton();
        btBuscar = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        lblReg = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        lbTotal = new javax.swing.JLabel();

        jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createEtchedBorder(), "PROVEEDOR", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 11))); // NOI18N

        CboProveedor.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "<Todos>" }));
        CboProveedor.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CboProveedorActionPerformed(evt);
            }
        });

        lblVendedor.setText("Cliente/Proveedor");

        lblVendedor1.setText("Convenio");

        CboConvenio.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "<Todos>" }));
        CboConvenio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CboConvenioActionPerformed(evt);
            }
        });

        jLabel2.setText("Rut :");

        lblRut.setText("...");

        jLabel3.setText("Codigo: ");

        lblCodConv.setText("...");

        Grilla.setAutoCreateRowSorter(true);
        Grilla.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Rut ", "Cliente / Proveedor", "Convenio", "Sku", "Descripcion", "F. Emision", "Tipo Doc.", "Nro Doc", "Cantidad", "Precio", "Total Linea"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                true, true, true, false, true, false, true, true, true, true, true
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        Grilla.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                GrillaMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(Grilla);
        if (Grilla.getColumnModel().getColumnCount() > 0) {
            Grilla.getColumnModel().getColumn(0).setMinWidth(75);
            Grilla.getColumnModel().getColumn(0).setPreferredWidth(75);
            Grilla.getColumnModel().getColumn(0).setMaxWidth(75);
            Grilla.getColumnModel().getColumn(1).setMinWidth(300);
            Grilla.getColumnModel().getColumn(1).setPreferredWidth(300);
            Grilla.getColumnModel().getColumn(1).setMaxWidth(300);
            Grilla.getColumnModel().getColumn(2).setMinWidth(150);
            Grilla.getColumnModel().getColumn(2).setPreferredWidth(150);
            Grilla.getColumnModel().getColumn(2).setMaxWidth(150);
            Grilla.getColumnModel().getColumn(3).setMinWidth(80);
            Grilla.getColumnModel().getColumn(3).setPreferredWidth(80);
            Grilla.getColumnModel().getColumn(3).setMaxWidth(80);
            Grilla.getColumnModel().getColumn(4).setMinWidth(200);
            Grilla.getColumnModel().getColumn(4).setPreferredWidth(200);
            Grilla.getColumnModel().getColumn(4).setMaxWidth(200);
            Grilla.getColumnModel().getColumn(5).setMinWidth(80);
            Grilla.getColumnModel().getColumn(5).setPreferredWidth(80);
            Grilla.getColumnModel().getColumn(5).setMaxWidth(80);
            Grilla.getColumnModel().getColumn(6).setMinWidth(60);
            Grilla.getColumnModel().getColumn(6).setPreferredWidth(60);
            Grilla.getColumnModel().getColumn(6).setMaxWidth(60);
            Grilla.getColumnModel().getColumn(7).setMinWidth(80);
            Grilla.getColumnModel().getColumn(7).setPreferredWidth(80);
            Grilla.getColumnModel().getColumn(7).setMaxWidth(80);
            Grilla.getColumnModel().getColumn(8).setMinWidth(80);
            Grilla.getColumnModel().getColumn(8).setPreferredWidth(80);
            Grilla.getColumnModel().getColumn(8).setMaxWidth(80);
            Grilla.getColumnModel().getColumn(9).setMinWidth(100);
            Grilla.getColumnModel().getColumn(9).setPreferredWidth(100);
            Grilla.getColumnModel().getColumn(9).setMaxWidth(100);
            Grilla.getColumnModel().getColumn(10).setMinWidth(150);
            Grilla.getColumnModel().getColumn(10).setPreferredWidth(150);
            Grilla.getColumnModel().getColumn(10).setMaxWidth(150);
        }

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(CboProveedor, javax.swing.GroupLayout.PREFERRED_SIZE, 443, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(lblVendedor)
                        .addGap(49, 49, 49)
                        .addComponent(jLabel2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(lblRut, javax.swing.GroupLayout.PREFERRED_SIZE, 108, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(35, 35, 35)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(lblVendedor1)
                        .addGap(60, 60, 60)
                        .addComponent(jLabel3)
                        .addGap(18, 18, 18)
                        .addComponent(lblCodConv, javax.swing.GroupLayout.PREFERRED_SIZE, 108, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(CboConvenio, javax.swing.GroupLayout.PREFERRED_SIZE, 497, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(392, Short.MAX_VALUE))
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 1357, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel3)
                        .addComponent(lblCodConv))
                    .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(lblVendedor)
                        .addComponent(lblVendedor1)
                        .addComponent(jLabel2)
                        .addComponent(lblRut)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(CboProveedor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(CboConvenio, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 275, Short.MAX_VALUE))
        );

        jPanel1.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        buttonGroup1.add(rb_compra);
        rb_compra.setText("Compra");
        rb_compra.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rb_compraActionPerformed(evt);
            }
        });

        buttonGroup1.add(rb_venta);
        rb_venta.setText("Venta");
        rb_venta.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rb_ventaActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(28, 28, 28)
                .addComponent(rb_venta)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 70, Short.MAX_VALUE)
                .addComponent(rb_compra)
                .addGap(48, 48, 48))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap(18, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(rb_compra)
                    .addComponent(rb_venta))
                .addGap(17, 17, 17))
        );

        btBuscar.setText("Buscar");
        btBuscar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btBuscarActionPerformed(evt);
            }
        });

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel1.setText("Registros");

        lblReg.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        lblReg.setText("0");

        jLabel6.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel6.setText("Total");

        lbTotal.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        lbTotal.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lbTotal.setText("0.00");
        lbTotal.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        lbTotal.setInheritsPopupMenu(false);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(97, 97, 97)
                        .addComponent(btBuscar)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel1)
                .addGap(38, 38, 38)
                .addComponent(lblReg, javax.swing.GroupLayout.PREFERRED_SIZE, 116, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel6)
                .addGap(18, 18, 18)
                .addComponent(lbTotal, javax.swing.GroupLayout.PREFERRED_SIZE, 209, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(37, 37, 37))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(26, 26, 26)
                        .addComponent(btBuscar)))
                .addGap(18, 18, 18)
                .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel6)
                        .addComponent(lbTotal))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel1)
                            .addComponent(lblReg))
                        .addContainerGap())))
        );
    }// </editor-fold>//GEN-END:initComponents

    
    
    private void CargaProveedor(){
        DefaultComboBoxModel value;
        ExeSql Sql = new ExeSql();
        ResultSet Rs;
        String Query="";
        CboProveedor.removeAllItems();
//        CboProveedor.addItem("<Todos>");  
//        CboProveedor.setSelectedIndex(0);
        value =new DefaultComboBoxModel();
       
        
        
        try {
            
            if (rb_compra.isSelected())
            {           
            Query="select rut,trim(nombre) nombre from proveedor\n" +
                    "order by trim(nombre)";}
            else{
                Query="select rut,trim(nombre) nombre from cliente\n" +
                    "order by trim(nombre)";}
            
            Rs = Sql.Select(Query);
            if(Sql.GetRowCount()==0) return;
           value.addElement(new ComboCodigos("Seleccione",0));     
           while(Rs.next()){
            value.addElement(new ComboCodigos(Rs.getString("nombre").trim(),Rs.getInt("rut")));
           } 
           CboProveedor.setModel(value);
           CboProveedor.setSelectedIndex(0);

           
           
        } catch (Exception e) {
            System.out.println(e);
        }
        finally{
            Sql.Close();
        }
    }
    
    
   private void CargaConvenio(){
        DefaultComboBoxModel value;
        ExeSql Sql = new ExeSql();
        ResultSet Rs;
        String Query="";
//        CboConvenio.removeAllItems();
//        CboConvenio.addItem("<Todos>");  // Agrego la condicion inicial de Todos
        
        value =new DefaultComboBoxModel();
      
        
        
        try {
            Query="select codigo,convenio from par_convenio \n" +
                "order by codigo  ";
            Rs = Sql.Select(Query);
            if(Sql.GetRowCount()==0) return;
             value.addElement(new ComboCodigos("Seleccione",0));
             
           while(Rs.next()){
            value.addElement(new ComboCodigos(Rs.getString("convenio").trim(),Rs.getInt("codigo")));
           } 
           CboConvenio.setModel(value);
           CboConvenio.setSelectedIndex(0);

        } catch (Exception e) {
            System.out.println(e);
        }
        finally{
            Sql.Close();
        }
    }
    
    
    private void btBuscarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btBuscarActionPerformed
        ExeSql Sql = new ExeSql();
        ResultSet Rs;
        String Query="";
        String NombrePersonal;
        DefaultTableModel TableModel = (DefaultTableModel) Grilla.getModel();
        int ContReg=0;
        double total =0.00;
        
        
        
        if (CboProveedor.getSelectedIndex() ==0 && CboConvenio.getSelectedIndex() ==0 ){
            fmMain.Mensaje("Debe seleccionar un proveedor o un convenio ");
             return;
        }
        
            
        while(TableModel.getRowCount()>0)
           TableModel.removeRow(0);        
        lblReg.setText("0");
        lbTotal.setText("0");
        
        
try {
//                       

// Query para Compras
    
    

if (rb_venta.isSelected()) {
Query= " SELECT  \n" +
"c.rut rut,\n" +
"cl.nombre nombre,\n" +
"conv.codigo,conv.convenio,\n" +
"p.sku,p.nombre nombre_prod,c.femision,c.tipdocto,c.nrodocto, d.cantidad, d.valorunitario,d.totallinea\n" +
"					from ctactecli c\n" +
"                       left join ctacteclidet d on c.rut = d.rut and c.tipdocto =\n" +
"                        d.tipdocto and c.nrodocto = d.nrodocto\n" +
"                       left join producto p on d.sku = p.sku\n" +
"                       left join par_convenio conv on conv.codigo = p.convenio\n" +
"                       left join cliente cl on cl.rut = c.rut\n" +
"                  where c.tipdocto ='FAC' and\n" +
"                  conv.convenio is not null \n";
}
else if (rb_compra.isSelected()) {
 Query = " SELECT  \n" +
"c.rut rut,\n" +
"cl.nombre nombre,\n" +
"conv.codigo,conv.convenio,\n" +
"p.sku,p.nombre nombre_prod,c.femision,c.tipdocto,c.nrodocto, d.cantidad, d.valorunitario,d.totallinea\n" +
"					from ctacteprv c\n" +
"                       left join ctacteprvdet d on c.rut = d.rut and c.tipdocto =\n" +
"                        d.tipdocto and c.nrodocto = d.nrodocto\n" +
"                       left join producto p on d.sku = p.sku\n" +
"                       left join par_convenio conv on conv.codigo = p.convenio\n" +
"                       left join proveedor cl on cl.rut = c.rut\n" +
"                  where c.tipdocto ='FAP' and\n" +
"                  conv.convenio is not null " ;  
}

 if(CboProveedor.getSelectedIndex() >0 && CboConvenio.getSelectedIndex() >0 ){
    Query = Query +   " and c.rut = " + id_proveedor + " \n";  
    Query = Query +   " and conv.codigo  = " + id_convenio + " \n";  
 } else if(CboConvenio.getSelectedIndex() >0){
    Query = Query +   " and conv.codigo  = " + id_convenio + " \n";  
 }else if(CboProveedor.getSelectedIndex() >0)
 {
     Query = Query +   " and c.rut = " + id_proveedor + " \n";  
 }  
  // EJECUTA CONSULTA
            Rs = Sql.Select(Query);
            
            while(Rs.next()){
                ContReg++;
              TableModel.addRow(new Object[]{
                                                Rs.getInt("rut"), 
                                                Rs.getString("nombre").trim(), 
                                                Rs.getString("convenio").trim(), 
                                                Rs.getString("sku").trim(), 
                                                Rs.getString("nombre_prod").trim(), 
                                                Rs.getString("femision"),
                                                Rs.getString("tipdocto"),
                                                Rs.getInt("nrodocto"),
                                                Rs.getDouble("cantidad"),
                                                Rs.getDouble("valorunitario"),
                                                Rs.getDouble("totallinea")});
                                                total = total + Rs.getDouble("totallinea");
       }
         lblReg.setText(String.valueOf(ContReg));
         lbTotal.setText(fmMain.FormatoNumero(total));
    }
catch (Exception e) {
            fmMain.Mensaje("Existe una inconsistencia en la informaci√≥n.");
        }finally{
            Sql.Close();
        }
            
        
    }//GEN-LAST:event_btBuscarActionPerformed

    private void CboProveedorActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CboProveedorActionPerformed
       
    try{    
        
        
        ComboCodigos proveedor = (ComboCodigos) CboProveedor.getSelectedItem() ;
         
        if (CboProveedor.getSelectedItem()!= null){
            id_proveedor = proveedor.getId();
            lblRut.setText(String.valueOf(id_proveedor));
        }
        //btBuscar.doClick();        
    } catch (Exception e) {
                fmMain.Mensaje(e.getMessage());
            }
    }//GEN-LAST:event_CboProveedorActionPerformed

    private void CboConvenioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CboConvenioActionPerformed
        // TODO add your handling code here:
             ComboCodigos convenio = (ComboCodigos) CboConvenio.getSelectedItem() ;
          if (CboConvenio.getSelectedItem()!= null){   
                    id_convenio = convenio.getId();
                    lblCodConv.setText(String.valueOf(id_convenio));
          }         
         
        //btBuscar.doClick();   
    }//GEN-LAST:event_CboConvenioActionPerformed

    private void rb_ventaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rb_ventaActionPerformed
       CargaProveedor();
    }//GEN-LAST:event_rb_ventaActionPerformed

    private void rb_compraActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rb_compraActionPerformed
      CargaProveedor();
    }//GEN-LAST:event_rb_compraActionPerformed

    private void GrillaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_GrillaMouseClicked

    }//GEN-LAST:event_GrillaMouseClicked
//6700

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JComboBox<String> CboConvenio;
    private javax.swing.JComboBox<String> CboProveedor;
    private javax.swing.JTable Grilla;
    private javax.swing.JButton btBuscar;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JScrollPane jScrollPane1;
    private org.jdesktop.swingx.JXDatePicker jXDatePicker1;
    private javax.swing.JLabel lbTotal;
    private javax.swing.JLabel lblCodConv;
    private javax.swing.JLabel lblReg;
    private javax.swing.JLabel lblRut;
    private javax.swing.JLabel lblVendedor;
    private javax.swing.JLabel lblVendedor1;
    private javax.swing.JRadioButton rb_compra;
    private javax.swing.JRadioButton rb_venta;
    // End of variables declaration//GEN-END:variables
}
