/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package PanelForm;

import Conexion.ExeSql;
import Dialogos.jdAgregaDato;
import Formularios.fmMain;
import java.awt.event.KeyEvent;
import java.sql.ResultSet;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author David Alcaman
 */
public class pfPersonal extends javax.swing.JPanel {
    int Estadogeneral;
    String RutGeneral;
    /**
     * Creates new form pfPersonal
     */
    public pfPersonal() {
        initComponents();
        SetEstado(0);
        txDepaId.setVisible(false);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        pnMenu = new javax.swing.JPanel();
        btNuevo = new javax.swing.JButton();
        btGuardar = new javax.swing.JButton();
        btCancelar = new javax.swing.JButton();
        btAbrir = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        btEditar = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        txDepartamento = new javax.swing.JTextField();
        btDepartamento = new javax.swing.JButton();
        jPanel3 = new javax.swing.JPanel();
        txRut = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        txDv = new javax.swing.JTextField();
        jLabel10 = new javax.swing.JLabel();
        btIr = new javax.swing.JButton();
        txPaterno = new javax.swing.JTextField();
        txMaterno = new javax.swing.JTextField();
        txNombre = new javax.swing.JTextField();
        jLabel11 = new javax.swing.JLabel();
        jPanel4 = new javax.swing.JPanel();
        jLabel12 = new javax.swing.JLabel();
        jLabel13 = new javax.swing.JLabel();
        jLabel14 = new javax.swing.JLabel();
        jLabel15 = new javax.swing.JLabel();
        txDireccion = new javax.swing.JTextField();
        txPoblacion = new javax.swing.JTextField();
        txCiudad = new javax.swing.JTextField();
        txCelular = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        GrillaHaberes = new javax.swing.JTable();
        jScrollPane2 = new javax.swing.JScrollPane();
        GrillaDescuentos = new javax.swing.JTable();
        btAgregaH = new javax.swing.JButton();
        btEliminaH = new javax.swing.JButton();
        btAgregaD = new javax.swing.JButton();
        btEliminaD = new javax.swing.JButton();
        txDepaId = new javax.swing.JTextField();

        pnMenu.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        btNuevo.setFont(new java.awt.Font("Arial", 0, 11)); // NOI18N
        btNuevo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos16/add16.png"))); // NOI18N
        btNuevo.setText("Nuevo");
        btNuevo.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        btNuevo.setBorderPainted(false);
        btNuevo.setEnabled(false);
        btNuevo.setFocusPainted(false);
        btNuevo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btNuevoActionPerformed(evt);
            }
        });

        btGuardar.setFont(new java.awt.Font("Arial", 0, 11)); // NOI18N
        btGuardar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos16/save16.png"))); // NOI18N
        btGuardar.setText("Guardar");
        btGuardar.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        btGuardar.setBorderPainted(false);
        btGuardar.setEnabled(false);
        btGuardar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btGuardarActionPerformed(evt);
            }
        });

        btCancelar.setFont(new java.awt.Font("Arial", 0, 11)); // NOI18N
        btCancelar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos16/Cancel16.png"))); // NOI18N
        btCancelar.setText("Cancelar");
        btCancelar.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        btCancelar.setBorderPainted(false);
        btCancelar.setEnabled(false);
        btCancelar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btCancelarActionPerformed(evt);
            }
        });

        btAbrir.setFont(new java.awt.Font("Arial", 0, 11)); // NOI18N
        btAbrir.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos16/open16.png"))); // NOI18N
        btAbrir.setText("Abrir");
        btAbrir.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        btAbrir.setBorderPainted(false);
        btAbrir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btAbrirActionPerformed(evt);
            }
        });

        jLabel1.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jLabel1.setText("PERSONAL");

        btEditar.setFont(new java.awt.Font("Arial", 0, 11)); // NOI18N
        btEditar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos16/Pencil16.png"))); // NOI18N
        btEditar.setText("Editar");
        btEditar.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        btEditar.setBorderPainted(false);
        btEditar.setEnabled(false);
        btEditar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btEditarActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout pnMenuLayout = new javax.swing.GroupLayout(pnMenu);
        pnMenu.setLayout(pnMenuLayout);
        pnMenuLayout.setHorizontalGroup(
            pnMenuLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnMenuLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel1)
                .addGap(18, 18, 18)
                .addComponent(btGuardar, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btCancelar, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btNuevo, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btAbrir, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btEditar, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(312, Short.MAX_VALUE))
        );
        pnMenuLayout.setVerticalGroup(
            pnMenuLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnMenuLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnMenuLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btCancelar, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btAbrir, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel1)
                    .addComponent(btNuevo, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btGuardar, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btEditar, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        jPanel1.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jPanel2.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));

        jLabel2.setBackground(new java.awt.Color(242, 222, 184));
        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel2.setText("Departamento");
        jLabel2.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));
        jLabel2.setOpaque(true);

        btDepartamento.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos22/Go.png"))); // NOI18N
        btDepartamento.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btDepartamentoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 101, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txDepartamento, javax.swing.GroupLayout.PREFERRED_SIZE, 270, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btDepartamento, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(btDepartamento, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel2)
                        .addComponent(txDepartamento, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel3.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));

        txRut.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txRutKeyPressed(evt);
            }
        });

        jLabel7.setBackground(new java.awt.Color(242, 222, 184));
        jLabel7.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel7.setText("Apellido Paterno");
        jLabel7.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));
        jLabel7.setOpaque(true);

        jLabel8.setText("Dv");

        jLabel9.setBackground(new java.awt.Color(242, 222, 184));
        jLabel9.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel9.setText("Apellido Materno");
        jLabel9.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));
        jLabel9.setOpaque(true);

        jLabel10.setBackground(new java.awt.Color(242, 222, 184));
        jLabel10.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel10.setText("Nombres");
        jLabel10.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));
        jLabel10.setOpaque(true);

        btIr.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos22/Go.png"))); // NOI18N
        btIr.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btIrActionPerformed(evt);
            }
        });

        txPaterno.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txPaternoActionPerformed(evt);
            }
        });

        jLabel11.setBackground(new java.awt.Color(242, 222, 184));
        jLabel11.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel11.setText("Rut");
        jLabel11.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));
        jLabel11.setOpaque(true);

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(jLabel11, javax.swing.GroupLayout.PREFERRED_SIZE, 101, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txRut, javax.swing.GroupLayout.PREFERRED_SIZE, 103, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel8)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txDv, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btIr, javax.swing.GroupLayout.PREFERRED_SIZE, 21, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 101, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txPaterno, javax.swing.GroupLayout.PREFERRED_SIZE, 269, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 101, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txMaterno))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(jLabel10, javax.swing.GroupLayout.PREFERRED_SIZE, 101, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txNombre, javax.swing.GroupLayout.PREFERRED_SIZE, 269, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(27, 27, 27)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel11)
                    .addComponent(txRut, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel8)
                    .addComponent(txDv, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btIr, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
                .addGap(1, 1, 1)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel7)
                    .addComponent(txPaterno, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(1, 1, 1)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel9)
                    .addComponent(txMaterno, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(1, 1, 1)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel10)
                    .addComponent(txNombre, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        jPanel4.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));

        jLabel12.setBackground(new java.awt.Color(242, 222, 184));
        jLabel12.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel12.setText("Villa/Población");
        jLabel12.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));
        jLabel12.setOpaque(true);

        jLabel13.setBackground(new java.awt.Color(242, 222, 184));
        jLabel13.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel13.setText("Ciudad");
        jLabel13.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));
        jLabel13.setOpaque(true);

        jLabel14.setBackground(new java.awt.Color(242, 222, 184));
        jLabel14.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel14.setText("Celular");
        jLabel14.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));
        jLabel14.setOpaque(true);

        jLabel15.setBackground(new java.awt.Color(242, 222, 184));
        jLabel15.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel15.setText("Dirección");
        jLabel15.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));
        jLabel15.setOpaque(true);

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(jLabel15, javax.swing.GroupLayout.PREFERRED_SIZE, 101, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txDireccion, javax.swing.GroupLayout.PREFERRED_SIZE, 271, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, 101, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txPoblacion))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(jLabel13, javax.swing.GroupLayout.PREFERRED_SIZE, 101, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txCiudad))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(jLabel14, javax.swing.GroupLayout.PREFERRED_SIZE, 101, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txCelular)))
                .addContainerGap(76, Short.MAX_VALUE))
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel15)
                    .addComponent(txDireccion, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(1, 1, 1)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel12)
                    .addComponent(txPoblacion, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(1, 1, 1)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel13)
                    .addComponent(txCiudad, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(1, 1, 1)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel14)
                    .addComponent(txCelular, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(23, Short.MAX_VALUE))
        );

        GrillaHaberes.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null},
                {null, null},
                {null, null},
                {null, null}
            },
            new String [] {
                "HABERES", "codigo"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane1.setViewportView(GrillaHaberes);
        if (GrillaHaberes.getColumnModel().getColumnCount() > 0) {
            GrillaHaberes.getColumnModel().getColumn(1).setMinWidth(0);
            GrillaHaberes.getColumnModel().getColumn(1).setPreferredWidth(0);
            GrillaHaberes.getColumnModel().getColumn(1).setMaxWidth(0);
        }

        GrillaDescuentos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null},
                {null, null},
                {null, null},
                {null, null}
            },
            new String [] {
                "DESCUENTOS", "codigo"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane2.setViewportView(GrillaDescuentos);
        if (GrillaDescuentos.getColumnModel().getColumnCount() > 0) {
            GrillaDescuentos.getColumnModel().getColumn(1).setMinWidth(0);
            GrillaDescuentos.getColumnModel().getColumn(1).setPreferredWidth(0);
            GrillaDescuentos.getColumnModel().getColumn(1).setMaxWidth(0);
        }

        btAgregaH.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos16/Agregar.png"))); // NOI18N
        btAgregaH.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btAgregaHActionPerformed(evt);
            }
        });

        btEliminaH.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos16/Eliminar.png"))); // NOI18N
        btEliminaH.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btEliminaHActionPerformed(evt);
            }
        });

        btAgregaD.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos16/Agregar.png"))); // NOI18N
        btAgregaD.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btAgregaDActionPerformed(evt);
            }
        });

        btEliminaD.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos16/Eliminar.png"))); // NOI18N
        btEliminaD.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btEliminaDActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txDepaId, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(jPanel2, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jPanel3, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 326, Short.MAX_VALUE)
                            .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
                        .addGap(6, 6, 6)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(btAgregaH, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btEliminaH, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btAgregaD, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btEliminaD, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                        .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(btAgregaH)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btEliminaH)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addGroup(jPanel1Layout.createSequentialGroup()
                            .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(btAgregaD)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btEliminaD)))
                .addGap(18, 18, 18)
                .addComponent(txDepaId, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(124, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(pnMenu, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(pnMenu, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
    }// </editor-fold>//GEN-END:initComponents
    private void SetEstado(int ElEstado){
        if(ElEstado==0){
            Estadogeneral=ElEstado;
            Limpia();
            Editar(false);
            Habilitar(false);
        }
        else if(ElEstado==1){
            Estadogeneral=ElEstado;
            Limpia();
            Habilitar(false);
            txRut.setEnabled(true);
            txRut.setEditable(true);
            btIr.setEnabled(true);
            txRut.requestFocus();
            btGuardar.setEnabled(false);
            btCancelar.setEnabled(false);
            btNuevo.setEnabled(false);
            btAbrir.setEnabled(true);
            btEditar.setEnabled(false);
        }
        else if(ElEstado==2){
            Estadogeneral=ElEstado;
            Habilitar(true);
            Editar(true);
            btGuardar.setEnabled(true);
            btCancelar.setEnabled(true);
            btNuevo.setEnabled(false);
            btAbrir.setEnabled(false);
            btEditar.setEnabled(false);
        }
    }
    private void Limpia(){
        txRut.setText("");
        txDv.setText("");
        txPaterno.setText("");
        txMaterno.setText("");
        txNombre.setText("");
        txDepartamento.setText("");
        txDireccion.setText("");
        txPoblacion.setText("");
        txCiudad.setText("");
        txCelular.setText("");
        fmMain.LimpiaGrilla((DefaultTableModel) GrillaHaberes.getModel());
        fmMain.LimpiaGrilla((DefaultTableModel) GrillaDescuentos.getModel());
    }
    private void Editar(boolean Estado){
        txRut.setEditable(Estado);
        txDv.setEditable(Estado);
        txPaterno.setEditable(Estado);
        txMaterno.setEditable(Estado);
        txNombre.setEditable(Estado);
        txDireccion.setEditable(Estado);
        txPoblacion.setEditable(Estado);
        txCiudad.setEditable(Estado);
        txCelular.setEditable(Estado);
        
        btAgregaD.setEnabled(Estado);
        btAgregaH.setEnabled(Estado);
        btEliminaD.setEnabled(Estado);
        btEliminaH.setEnabled(Estado);
        btDepartamento.setEnabled(Estado);
    }
    private void Habilitar(boolean Estado){
        txRut.setEnabled(Estado);
        txDv.setEnabled(Estado);
        txPaterno.setEnabled(Estado);
        txMaterno.setEnabled(Estado);
        txNombre.setEnabled(Estado);
        txDepartamento.setEnabled(Estado);
        txDireccion.setEnabled(Estado);
        txPoblacion.setEnabled(Estado);
        txCiudad.setEnabled(Estado);
        txCelular.setEnabled(Estado);
    }
    private void btAbrirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btAbrirActionPerformed
        SetEstado(1);        // TODO add your handling code here:
    }//GEN-LAST:event_btAbrirActionPerformed

    private void txRutKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txRutKeyPressed
        if(evt.getKeyCode()==KeyEvent.VK_ENTER){
            btIr.doClick();
        }
    }//GEN-LAST:event_txRutKeyPressed

    private void btIrActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btIrActionPerformed
        if (!txRut.getText().isEmpty()) {
            CargaPersonal(txRut.getText().trim());
        } else {
            jdAgregaDato Dato = new jdAgregaDato(null, true);
            Dato.setLocationRelativeTo(null);
            Dato.setTitle("Trabajador");
            Dato.CargaDatos("select rut as codigo,nombre\n"
                    + "from personal \n"
                    + "where rut>1000\n"
                    + "order by nombre ");
            Dato.setVisible(true);
            if (!Dato.GetCodigo().isEmpty()) {
                CargaPersonal(Dato.GetCodigo());
            }
            else{
                SetEstado(0);
            }
        }
    }//GEN-LAST:event_btIrActionPerformed

    private void btAgregaHActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btAgregaHActionPerformed
        String Codigos = "";
        String Query="";
        
        if(GrillaHaberes.getRowCount()==0)
            Query = "select codigo,nombre\n" +
                    "from par_general\n" +
                    "where tipo='REM_HABERES'";
        else{
            for(int i=0; i< GrillaHaberes.getRowCount();i++){
                Codigos = Codigos + GrillaHaberes.getValueAt(i,1).toString().trim() + ",";
            }
            if(Codigos.length()>0)
            Codigos = Codigos.substring(0, Codigos.length()-1);
            Query = "select codigo,nombre\n" +
                    "from par_general where tipo='REM_HABERES' and codigo not in ("+ Codigos +")";
        } 
        
        jdAgregaDato Dato = new jdAgregaDato(null, true);
        Dato.setLocationRelativeTo(null);
        Dato.setTitle("Haberes");
        Dato.CargaDatos(Query);
        Dato.setVisible(true);
        if (!Dato.GetCodigo().isEmpty()) {
            DefaultTableModel Model = (DefaultTableModel)GrillaHaberes.getModel();
            Model.addRow(new Object[]{Dato.GetNombre(),Dato.GetCodigo()});
        }
    }//GEN-LAST:event_btAgregaHActionPerformed

    private void btEditarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btEditarActionPerformed
        SetEstado(2);
        RutGeneral=txRut.getText().trim();
    }//GEN-LAST:event_btEditarActionPerformed

    private void btAgregaDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btAgregaDActionPerformed
        String Codigos = "";
        String Query="";
        
        if(GrillaHaberes.getRowCount()==0)
            Query = "select codigo,nombre\n" +
                    "from par_general\n" +
                    "where tipo='REM_DESCUENTOS'";
        else{
            for(int i=0; i< GrillaHaberes.getRowCount();i++){
                Codigos = Codigos + GrillaHaberes.getValueAt(i,1).toString().trim() + ",";
            }
            if(Codigos.length()>0)
            Codigos = Codigos.substring(0, Codigos.length()-1);
            Query = "select codigo,nombre\n" +
                    "from par_general where tipo='REM_DESCUENTOS' and codigo not in ("+ Codigos +")";
        } 
        
        jdAgregaDato Dato = new jdAgregaDato(null, true);
        Dato.setLocationRelativeTo(null);
        Dato.setTitle("Descuentos");
        Dato.CargaDatos(Query);
        Dato.setVisible(true);
        if (!Dato.GetCodigo().isEmpty()) {
            DefaultTableModel Model = (DefaultTableModel)GrillaDescuentos.getModel();
            Model.addRow(new Object[]{Dato.GetNombre(),Dato.GetCodigo()});
        }
    }//GEN-LAST:event_btAgregaDActionPerformed

    private void txPaternoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txPaternoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txPaternoActionPerformed

    private void btEliminaHActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btEliminaHActionPerformed
        DefaultTableModel Model = (DefaultTableModel)GrillaHaberes.getModel();
        Model.removeRow(GrillaHaberes.getSelectedRow());
    }//GEN-LAST:event_btEliminaHActionPerformed

    private void btEliminaDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btEliminaDActionPerformed
        DefaultTableModel Model = (DefaultTableModel)GrillaDescuentos.getModel();
        Model.removeRow(GrillaDescuentos.getSelectedRow());
    }//GEN-LAST:event_btEliminaDActionPerformed

    private void btCancelarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btCancelarActionPerformed
        if(Estadogeneral==2){
            String Rut=txRut.getText().trim();
            SetEstado(1);
            CargaPersonal(Rut);
        }
            
                
                    
    }//GEN-LAST:event_btCancelarActionPerformed

    private void btGuardarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btGuardarActionPerformed
        ExeSql Sql = new ExeSql();
        try {
            Sql.ExeSql("update personal set \n" +
                       "apellidopaterno='"+ txPaterno.getText().trim() +"',\n" +
                       "apellidomaterno='"+ txMaterno.getText().trim() +"',\n" +
                       "nombre='"+ txNombre.getText().trim() +"',\n" +
                       "direccion='"+ txDireccion.getText().trim() +"',\n" +
                       "poblacion='"+ txPoblacion.getText().trim() +"',\n" +
                       "ciudad='"+ txCiudad.getText().trim() +"',\n" +
                       "celular='"+ txCelular.getText().trim() +"'\n" +
                       "where rut=" + RutGeneral);
            
            if(!txDepaId.getText().isEmpty()){
                Sql.ExeSql("delete from personal_ccostos where rut=" + RutGeneral);
                Sql.ExeSql("insert into personal_ccostos (rut,ccosto) values (" + RutGeneral + "," + txDepaId.getText().trim() + ")");
            }
                
            
            Sql.ExeSql("delete from personalhd where rut="+ RutGeneral);
            
            for(int i=0;i<GrillaHaberes.getRowCount();i++){
                Sql.ExeSql("insert into personalhd (rut,tipo,codigo) values (" +
                           RutGeneral +  ",'REM_HABERES'," + GrillaHaberes.getValueAt(i, 1).toString().trim()+ ")");
            }
            
            for(int i=0;i<GrillaDescuentos.getRowCount();i++)
                Sql.ExeSql("insert into personalhd (rut,tipo,codigo) values (" +
                           RutGeneral +  ",'REM_DESCUENTOS'," + GrillaDescuentos.getValueAt(i, 1).toString().trim() + ")");
            
            Sql.Commit();
        } catch (Exception e) {
            fmMain.Mensaje(e.getMessage());
        } finally{
            Sql.Close();
            SetEstado(1);
            CargaPersonal(RutGeneral);
        }
    }//GEN-LAST:event_btGuardarActionPerformed

    private void btNuevoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btNuevoActionPerformed
        SetEstado(3);
    }//GEN-LAST:event_btNuevoActionPerformed

    private void btDepartamentoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btDepartamentoActionPerformed
        String Query="";

        Query = "select id as codigo,nombre\n" +
                "from pccostos\n" +
                "where id<>8";

        jdAgregaDato Dato = new jdAgregaDato(null, true);
        Dato.setLocationRelativeTo(null);
        Dato.setTitle("Departamentos");
        Dato.CargaDatos(Query);
        Dato.setVisible(true);

        if(!Dato.GetCodigo().isEmpty()){
            txDepartamento.setText(Dato.GetNombre());
            txDepaId.setText(Dato.GetCodigo());
            
        }
    }//GEN-LAST:event_btDepartamentoActionPerformed
    private void CargaAbonosDescuentos(String Rut){
        DefaultTableModel ModeloH = (DefaultTableModel) GrillaHaberes.getModel();
        DefaultTableModel ModeloD = (DefaultTableModel) GrillaDescuentos.getModel();
        
        fmMain.LimpiaGrilla(ModeloH);
        fmMain.LimpiaGrilla(ModeloD);
        
        ExeSql Sql = new ExeSql();
        ResultSet Rs;
        try {
            Rs = Sql.Select("select pg.tipo,pg.codigo,pg.nombre\n" +
                            "from personalhd hd \n" +
                            "left join par_general pg on pg.tipo=hd.tipo and pg.codigo=hd.codigo\n" +
                            "where hd.rut="+ Rut +"\n" +
                            "order by pg.tipo");
            while(Rs.next()){
                if(Rs.getString("tipo").trim().equals("REM_HABERES"))
                    ModeloH.addRow(new Object[]{Rs.getString("nombre").trim(),Rs.getInt("codigo")});
                else
                   ModeloD.addRow(new Object[]{Rs.getString("nombre").trim(),Rs.getInt("codigo")});
            }
        } catch (Exception e) {
            fmMain.Mensaje(e.getMessage());
        }finally{
            Sql.Close();
        }
    };
    private void CargaPersonal(String Rut){
        ExeSql Sql = new ExeSql();
        ResultSet Rs;
        
        try {
            Rs = Sql.Select("select cc.nombre as ccosto,cc.id,p.*\n" +
                            "from personal p\n" +
                            "left join personal_ccostos pc on p.rut=pc.rut and pc.ccosto<>8\n" +
                            "left join pccostos cc on pc.ccosto=cc.id\n" +
                            "where p.rut=" + Rut);
            if(Sql.GetRowCount()>0){
                Rs.next();
                txRut.setText(Rs.getString("Rut").trim());
                try{    txPaterno.setText(Rs.getString("apellidopaterno").trim());  }catch(Exception e){    txPaterno.setText("");}
                try{    txMaterno.setText(Rs.getString("apellidomaterno").trim());  }catch(Exception e){    txMaterno.setText("");}
                try{    txNombre.setText(Rs.getString("nombre").trim());            }catch(Exception e){    txNombre.setText("");}
                try{    txDepartamento.setText(Rs.getString("ccosto").trim());      }catch(Exception e){    txDepartamento.setText("");}
                try{    txDireccion.setText(Rs.getString("direccion").trim());      }catch(Exception e){    txDireccion.setText("");}
                try{    txPoblacion.setText(Rs.getString("poblacion").trim());      }catch(Exception e){    txPoblacion.setText("");}
                try{    txCiudad.setText(Rs.getString("ciudad").trim());            }catch(Exception e){    txCiudad.setText("");}
                try{    txCelular.setText(Rs.getString("celular").trim());          }catch(Exception e){    txCelular.setText("");}
                try{    txDepaId.setText(Rs.getString("id").trim());                }catch(Exception e){    txDepaId.setText("");}
                CargaAbonosDescuentos(Rut);
                Habilitar(true);
                btEditar.setEnabled(true);
            }
        } catch (Exception e) {
        }finally{
            Sql.Close();
        }
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTable GrillaDescuentos;
    private javax.swing.JTable GrillaHaberes;
    private javax.swing.JButton btAbrir;
    private javax.swing.JButton btAgregaD;
    private javax.swing.JButton btAgregaH;
    private javax.swing.JButton btCancelar;
    private javax.swing.JButton btDepartamento;
    private javax.swing.JButton btEditar;
    private javax.swing.JButton btEliminaD;
    private javax.swing.JButton btEliminaH;
    private javax.swing.JButton btGuardar;
    private javax.swing.JButton btIr;
    private javax.swing.JButton btNuevo;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JPanel pnMenu;
    private javax.swing.JTextField txCelular;
    private javax.swing.JTextField txCiudad;
    private javax.swing.JTextField txDepaId;
    private javax.swing.JTextField txDepartamento;
    private javax.swing.JTextField txDireccion;
    private javax.swing.JTextField txDv;
    private javax.swing.JTextField txMaterno;
    private javax.swing.JTextField txNombre;
    private javax.swing.JTextField txPaterno;
    private javax.swing.JTextField txPoblacion;
    private javax.swing.JTextField txRut;
    // End of variables declaration//GEN-END:variables
}
