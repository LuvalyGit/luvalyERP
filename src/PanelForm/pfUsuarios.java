/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package PanelForm;

import Conexion.ExeSql;
import Formularios.fmMain;
import java.awt.Color;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author David Alcaman
 */
public class pfUsuarios extends javax.swing.JPanel {

    int RolSala = 0;
    int Tipo = 0;   //0 = Nuevo  |  1 = Edita
    
    /**
     * Creates new form pfUsuarios
     */
    public pfUsuarios() {
      
        initComponents();
        CargaUsuarios();    
        Limpiar();
        CargaCCostos();
        GrillaCostos.changeSelection(0, 0 , false, false);
        lb1.setVisible(false);   
        
        chkSeparador.setEnabled(false);
        chkCajero.setEnabled(false);
        
        rbPLC.setEnabled(false);
        rbHRF.setEnabled(false);
        rbSinSALA.setEnabled(false);
        
        btEliminar.setVisible(false);
//      jPanel4.setVisible(false);  
        txCcosto.setVisible(false);

    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        buttonGroup2 = new javax.swing.ButtonGroup();
        pnMenu = new javax.swing.JPanel();
        btNuevo = new javax.swing.JButton();
        btGuardar = new javax.swing.JButton();
        btEliminar = new javax.swing.JButton();
        btEditar = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        txNombre = new javax.swing.JTextField();
        txUsuario = new javax.swing.JTextField();
        cbGrupo = new javax.swing.JComboBox();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        txPassword = new javax.swing.JPasswordField();
        jLabel6 = new javax.swing.JLabel();
        txPaterno = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();
        txRut = new javax.swing.JTextField();
        jLabel8 = new javax.swing.JLabel();
        txMaterno = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        txNivel = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        Grilla = new javax.swing.JTable();
        jPanel3 = new javax.swing.JPanel();
        jLabel3 = new javax.swing.JLabel();
        ch_administrador = new javax.swing.JCheckBox();
        ch_transformacion = new javax.swing.JCheckBox();
        ch_cobranza = new javax.swing.JCheckBox();
        ch_ajuste = new javax.swing.JCheckBox();
        ch_gastos = new javax.swing.JCheckBox();
        jSeparator1 = new javax.swing.JSeparator();
        ch_adminocp = new javax.swing.JCheckBox();
        ch_bodega = new javax.swing.JCheckBox();
        ch_ventaempresa = new javax.swing.JCheckBox();
        ch_eligeUbc = new javax.swing.JCheckBox();
        ch_auditoria = new javax.swing.JCheckBox();
        ch_asoc_vendedor = new javax.swing.JCheckBox();
        ch_separa_despacha = new javax.swing.JCheckBox();
        ch_recepcion = new javax.swing.JCheckBox();
        ch_configuracion = new javax.swing.JCheckBox();
        ch_asigna_separacion = new javax.swing.JCheckBox();
        ch_asoc_proveedor = new javax.swing.JCheckBox();
        ch_autoriza_separacion = new javax.swing.JCheckBox();
        ch_autoriza_ocp = new javax.swing.JCheckBox();
        ch_edita_ocp = new javax.swing.JCheckBox();
        ch_edita_nom_sku = new javax.swing.JCheckBox();
        jScrollPane2 = new javax.swing.JScrollPane();
        GrillaCostos = new javax.swing.JTable();
        esactivo = new javax.swing.JCheckBox();
        jPanel5 = new javax.swing.JPanel();
        chkCajero = new javax.swing.JCheckBox();
        rbPLC = new javax.swing.JRadioButton();
        rbHRF = new javax.swing.JRadioButton();
        rbSinSALA = new javax.swing.JRadioButton();
        chkSeparador = new javax.swing.JCheckBox();
        lb1 = new javax.swing.JLabel();
        txCcosto = new javax.swing.JTextField();
        lbCodVend = new javax.swing.JLabel();
        txCodVend = new javax.swing.JTextField();
        btCancelar = new javax.swing.JButton();

        pnMenu.setBackground(new java.awt.Color(220, 215, 226));

        btNuevo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos16/add16.png"))); // NOI18N
        btNuevo.setText("Nuevo");
        btNuevo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btNuevoActionPerformed(evt);
            }
        });

        btGuardar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos16/save16.png"))); // NOI18N
        btGuardar.setText("Guardar");
        btGuardar.setBorder(null);
        btGuardar.setEnabled(false);
        btGuardar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btGuardarActionPerformed(evt);
            }
        });

        btEliminar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos16/Cancel16.png"))); // NOI18N
        btEliminar.setText("Eliminar");
        btEliminar.setEnabled(false);
        btEliminar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btEliminarActionPerformed(evt);
            }
        });

        btEditar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos16/Pencil16.png"))); // NOI18N
        btEditar.setText("Editar");
        btEditar.setEnabled(false);
        btEditar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btEditarActionPerformed(evt);
            }
        });

        jPanel2.setBackground(new java.awt.Color(220, 215, 226));
        jPanel2.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jPanel1.setBackground(new java.awt.Color(220, 215, 226));
        jPanel1.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));

        jLabel1.setText("Nombres");

        jLabel2.setText("Usuario");

        txNombre.setEditable(false);
        txNombre.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txNombreActionPerformed(evt);
            }
        });
        txNombre.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txNombreKeyReleased(evt);
            }
        });

        txUsuario.setEditable(false);
        txUsuario.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txUsuarioKeyReleased(evt);
            }
        });

        cbGrupo.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Administrador", "Comprador", "Ventas", "Tesoreria" }));
        cbGrupo.setEnabled(false);

        jLabel4.setText("Grupo");

        jLabel5.setText("Clave");

        txPassword.setEditable(false);
        txPassword.setText("jPasswordField1");
        txPassword.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txPasswordActionPerformed(evt);
            }
        });

        jLabel6.setText("Paterno");

        txPaterno.setEditable(false);
        txPaterno.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txPaternoActionPerformed(evt);
            }
        });
        txPaterno.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txPaternoKeyReleased(evt);
            }
        });

        jLabel7.setText("Rut");

        txRut.setEditable(false);
        txRut.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txRutKeyReleased(evt);
            }
        });

        jLabel8.setText("Materno");

        txMaterno.setEditable(false);
        txMaterno.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txMaternoKeyReleased(evt);
            }
        });

        jLabel9.setText("Nivel");

        txNivel.setEditable(false);
        txNivel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txNivelActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(13, 13, 13)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel1)
                                    .addComponent(jLabel7)
                                    .addComponent(jLabel6)
                                    .addComponent(jLabel8))
                                .addGap(18, 18, 18)
                                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(txRut, javax.swing.GroupLayout.PREFERRED_SIZE, 116, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(txNombre, javax.swing.GroupLayout.DEFAULT_SIZE, 249, Short.MAX_VALUE)
                                    .addComponent(txPaterno)
                                    .addComponent(txMaterno)))
                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel1Layout.createSequentialGroup()
                                    .addComponent(jLabel5)
                                    .addGap(33, 33, 33)
                                    .addComponent(txPassword, javax.swing.GroupLayout.PREFERRED_SIZE, 1, Short.MAX_VALUE))
                                .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel1Layout.createSequentialGroup()
                                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                        .addComponent(jLabel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(jLabel2, javax.swing.GroupLayout.DEFAULT_SIZE, 45, Short.MAX_VALUE))
                                    .addGap(15, 15, 15)
                                    .addComponent(txUsuario, javax.swing.GroupLayout.PREFERRED_SIZE, 108, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(12, 12, 12)
                        .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(cbGrupo, javax.swing.GroupLayout.PREFERRED_SIZE, 196, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txNivel, javax.swing.GroupLayout.PREFERRED_SIZE, 107, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addGap(21, 21, 21))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel7)
                    .addComponent(txRut, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(4, 4, 4)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(txNombre, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel6)
                    .addComponent(txPaterno, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel8)
                    .addComponent(txMaterno, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel9)
                    .addComponent(txNivel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel4)
                    .addComponent(cbGrupo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 14, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txUsuario, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel5)
                    .addComponent(txPassword, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(26, 26, 26))
        );

        jLabel9.getAccessibleContext().setAccessibleName("lbnivel");

        Grilla.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Id", "Usuario", "id_usuario"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        Grilla.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                GrillaMouseClicked(evt);
            }
            public void mousePressed(java.awt.event.MouseEvent evt) {
                GrillaMousePressed(evt);
            }
        });
        jScrollPane1.setViewportView(Grilla);
        if (Grilla.getColumnModel().getColumnCount() > 0) {
            Grilla.getColumnModel().getColumn(0).setMinWidth(0);
            Grilla.getColumnModel().getColumn(0).setPreferredWidth(0);
            Grilla.getColumnModel().getColumn(0).setMaxWidth(0);
            Grilla.getColumnModel().getColumn(1).setMinWidth(180);
            Grilla.getColumnModel().getColumn(1).setPreferredWidth(180);
            Grilla.getColumnModel().getColumn(1).setMaxWidth(180);
            Grilla.getColumnModel().getColumn(2).setMinWidth(0);
            Grilla.getColumnModel().getColumn(2).setPreferredWidth(0);
            Grilla.getColumnModel().getColumn(2).setMaxWidth(0);
        }

        jPanel3.setBackground(new java.awt.Color(220, 215, 226));
        jPanel3.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));

        jLabel3.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(0, 51, 153));
        jLabel3.setText("Permisos");

        ch_administrador.setBackground(new java.awt.Color(220, 215, 226));
        ch_administrador.setText("Administrador");

        ch_transformacion.setBackground(new java.awt.Color(220, 215, 226));
        ch_transformacion.setText("Transformación");

        ch_cobranza.setBackground(new java.awt.Color(220, 215, 226));
        ch_cobranza.setText("Cobranza");
        ch_cobranza.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ch_cobranzaActionPerformed(evt);
            }
        });

        ch_ajuste.setBackground(new java.awt.Color(220, 215, 226));
        ch_ajuste.setText("Ajuste");

        ch_gastos.setBackground(new java.awt.Color(220, 215, 226));
        ch_gastos.setText("Gastos");

        ch_adminocp.setBackground(new java.awt.Color(220, 215, 226));
        ch_adminocp.setText("AdminOcp");

        ch_bodega.setBackground(new java.awt.Color(220, 215, 226));
        ch_bodega.setText("Bodega");

        ch_ventaempresa.setBackground(new java.awt.Color(220, 215, 226));
        ch_ventaempresa.setText("Venta Empresas");
        ch_ventaempresa.setToolTipText("");

        ch_eligeUbc.setBackground(new java.awt.Color(220, 215, 226));
        ch_eligeUbc.setText("Elige Ubicación");
        ch_eligeUbc.setToolTipText("");

        ch_auditoria.setBackground(new java.awt.Color(220, 215, 226));
        ch_auditoria.setText("Auditoria");

        ch_asoc_vendedor.setBackground(new java.awt.Color(220, 215, 226));
        ch_asoc_vendedor.setText("Asocia_Vendedor_OC");
        ch_asoc_vendedor.setToolTipText("");

        ch_separa_despacha.setBackground(new java.awt.Color(220, 215, 226));
        ch_separa_despacha.setText("Separación | Despacho");
        ch_separa_despacha.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ch_separa_despachaActionPerformed(evt);
            }
        });

        ch_recepcion.setBackground(new java.awt.Color(220, 215, 226));
        ch_recepcion.setText("Recepción");
        ch_recepcion.setToolTipText("");
        ch_recepcion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ch_recepcionActionPerformed(evt);
            }
        });

        ch_configuracion.setBackground(new java.awt.Color(220, 215, 226));
        ch_configuracion.setText("Configuración");
        ch_configuracion.setToolTipText("");
        ch_configuracion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ch_configuracionActionPerformed(evt);
            }
        });

        ch_asigna_separacion.setBackground(new java.awt.Color(220, 215, 226));
        ch_asigna_separacion.setText("Asigna Separación");
        ch_asigna_separacion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ch_asigna_separacionActionPerformed(evt);
            }
        });

        ch_asoc_proveedor.setBackground(new java.awt.Color(220, 215, 226));
        ch_asoc_proveedor.setText("Asocia_Proveedor");

        ch_autoriza_separacion.setBackground(new java.awt.Color(220, 215, 226));
        ch_autoriza_separacion.setText("Autoriza Separación");
        ch_autoriza_separacion.setToolTipText("");
        ch_autoriza_separacion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ch_autoriza_separacionActionPerformed(evt);
            }
        });

        ch_autoriza_ocp.setBackground(new java.awt.Color(220, 215, 226));
        ch_autoriza_ocp.setText("Autoriza OCP");
        ch_autoriza_ocp.setToolTipText("");
        ch_autoriza_ocp.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ch_autoriza_ocpActionPerformed(evt);
            }
        });

        ch_edita_ocp.setBackground(new java.awt.Color(220, 215, 226));
        ch_edita_ocp.setText("Edita OCP");
        ch_edita_ocp.setToolTipText("");
        ch_edita_ocp.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ch_edita_ocpActionPerformed(evt);
            }
        });

        ch_edita_nom_sku.setBackground(new java.awt.Color(220, 215, 226));
        ch_edita_nom_sku.setText("Edita Nombre SKU");
        ch_edita_nom_sku.setToolTipText("");
        ch_edita_nom_sku.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ch_edita_nom_skuActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 81, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addGap(0, 0, Short.MAX_VALUE)
                                .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 758, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel3Layout.createSequentialGroup()
                                .addComponent(ch_ventaempresa)
                                .addGap(18, 18, 18)
                                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(jPanel3Layout.createSequentialGroup()
                                        .addComponent(ch_administrador)
                                        .addGap(0, 0, Short.MAX_VALUE))
                                    .addGroup(jPanel3Layout.createSequentialGroup()
                                        .addComponent(ch_ajuste)
                                        .addGap(43, 43, 43)
                                        .addComponent(ch_asoc_proveedor)
                                        .addGap(46, 46, 46)
                                        .addComponent(ch_transformacion)
                                        .addGap(37, 37, 37)
                                        .addComponent(ch_cobranza)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(ch_gastos)
                                        .addGap(18, 18, 18)
                                        .addComponent(ch_adminocp)
                                        .addGap(40, 40, 40)
                                        .addComponent(ch_bodega)))))
                        .addGap(32, 32, 32))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(ch_eligeUbc)
                            .addComponent(ch_autoriza_ocp, javax.swing.GroupLayout.PREFERRED_SIZE, 103, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(ch_configuracion))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(ch_edita_ocp, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(ch_auditoria, javax.swing.GroupLayout.DEFAULT_SIZE, 80, Short.MAX_VALUE))
                        .addGap(20, 20, 20)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addComponent(ch_asoc_vendedor, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(ch_asigna_separacion, javax.swing.GroupLayout.PREFERRED_SIZE, 121, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(ch_autoriza_separacion, javax.swing.GroupLayout.PREFERRED_SIZE, 121, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(35, 35, 35)
                                .addComponent(ch_separa_despacha)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 43, Short.MAX_VALUE)
                                .addComponent(ch_recepcion, javax.swing.GroupLayout.PREFERRED_SIZE, 84, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(15, 15, 15))
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addComponent(ch_edita_nom_sku, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel3)
                    .addComponent(ch_configuracion)
                    .addComponent(ch_administrador))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 11, Short.MAX_VALUE)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(ch_ventaempresa)
                        .addComponent(ch_ajuste)
                        .addComponent(ch_asoc_proveedor)
                        .addComponent(ch_transformacion)
                        .addComponent(ch_cobranza))
                    .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(ch_gastos)
                        .addComponent(ch_bodega)
                        .addComponent(ch_adminocp)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 2, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(ch_eligeUbc)
                    .addComponent(ch_auditoria)
                    .addComponent(ch_asoc_vendedor)
                    .addComponent(ch_separa_despacha)
                    .addComponent(ch_recepcion)
                    .addComponent(ch_asigna_separacion)
                    .addComponent(ch_autoriza_separacion))
                .addGap(10, 10, 10)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(ch_autoriza_ocp)
                    .addComponent(ch_edita_ocp)
                    .addComponent(ch_edita_nom_sku)))
        );

        GrillaCostos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Id", "Centro Costo"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        GrillaCostos.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                GrillaCostosMouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(GrillaCostos);
        if (GrillaCostos.getColumnModel().getColumnCount() > 0) {
            GrillaCostos.getColumnModel().getColumn(0).setMinWidth(0);
            GrillaCostos.getColumnModel().getColumn(0).setPreferredWidth(0);
            GrillaCostos.getColumnModel().getColumn(0).setMaxWidth(0);
            GrillaCostos.getColumnModel().getColumn(1).setMinWidth(180);
            GrillaCostos.getColumnModel().getColumn(1).setPreferredWidth(180);
            GrillaCostos.getColumnModel().getColumn(1).setMaxWidth(180);
        }

        esactivo.setText("Activo");

        jPanel5.setBackground(new java.awt.Color(220, 215, 226));
        jPanel5.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));
        jPanel5.setToolTipText("");

        chkCajero.setText("Autorizado  SALA");
        chkCajero.setToolTipText("");
        chkCajero.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkCajeroActionPerformed(evt);
            }
        });

        buttonGroup2.add(rbPLC);
        rbPLC.setText("Sala PLC");

        buttonGroup2.add(rbHRF);
        rbHRF.setText("Sala HUERFANOS");
        rbHRF.setToolTipText("");

        buttonGroup2.add(rbSinSALA);
        rbSinSALA.setSelected(true);
        rbSinSALA.setText("Sin Asignación");
        rbSinSALA.setToolTipText("");

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGap(19, 19, 19)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(chkCajero, javax.swing.GroupLayout.PREFERRED_SIZE, 153, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                        .addComponent(rbSinSALA, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(rbHRF, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 139, Short.MAX_VALUE)
                        .addComponent(rbPLC, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addContainerGap(14, Short.MAX_VALUE))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(chkCajero)
                .addGap(18, 18, 18)
                .addComponent(rbPLC)
                .addGap(10, 10, 10)
                .addComponent(rbHRF)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(rbSinSALA)
                .addContainerGap())
        );

        chkSeparador.setBackground(new java.awt.Color(220, 215, 226));
        chkSeparador.setText("Separador");
        chkSeparador.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                chkSeparadorMouseClicked(evt);
            }
        });

        lb1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Iconos/Ok.png"))); // NOI18N

        txCcosto.setText("0");
        txCcosto.setToolTipText("");

        lbCodVend.setText("Código Vendedor");
        lbCodVend.setToolTipText("");

        txCodVend.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        txCodVend.setText("NULL");
        txCodVend.setToolTipText("");
        txCodVend.setEnabled(false);

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 181, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(txCcosto, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(lbCodVend, javax.swing.GroupLayout.PREFERRED_SIZE, 87, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(txCodVend, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 190, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(jPanel2Layout.createSequentialGroup()
                                    .addGap(10, 10, 10)
                                    .addComponent(esactivo, javax.swing.GroupLayout.PREFERRED_SIZE, 75, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGroup(jPanel2Layout.createSequentialGroup()
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                                .addGap(89, 89, 89)
                                .addComponent(chkSeparador, javax.swing.GroupLayout.PREFERRED_SIZE, 85, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(lb1)))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel2Layout.createSequentialGroup()
                                .addComponent(esactivo)
                                .addGap(18, 18, 18)
                                .addComponent(jPanel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 190, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lb1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(chkSeparador)
                                .addComponent(txCcosto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(lbCodVend)
                                .addComponent(txCodVend, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );

        btCancelar.setText("Cancelar");
        btCancelar.setEnabled(false);
        btCancelar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btCancelarActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout pnMenuLayout = new javax.swing.GroupLayout(pnMenu);
        pnMenu.setLayout(pnMenuLayout);
        pnMenuLayout.setHorizontalGroup(
            pnMenuLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnMenuLayout.createSequentialGroup()
                .addGroup(pnMenuLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(pnMenuLayout.createSequentialGroup()
                        .addGap(181, 181, 181)
                        .addComponent(btGuardar, javax.swing.GroupLayout.PREFERRED_SIZE, 91, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btCancelar)
                        .addGap(8, 8, 8)
                        .addComponent(btNuevo)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btEditar)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btEliminar))
                    .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(13, Short.MAX_VALUE))
        );
        pnMenuLayout.setVerticalGroup(
            pnMenuLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnMenuLayout.createSequentialGroup()
                .addGap(5, 5, 5)
                .addGroup(pnMenuLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btGuardar, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btCancelar)
                    .addComponent(btNuevo, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btEditar)
                    .addComponent(btEliminar))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(33, 33, 33))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(pnMenu, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(pnMenu, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
    }// </editor-fold>//GEN-END:initComponents
 //--------------------------------------------------------------------------------
// Funcion SET DE TIPOS
//--------------------------------------------------------------------------------
    private void SetTipo(int ElTipo){
        switch (ElTipo){
            //Nada
            case -1: break;
                
            //Nuevo
            case 1: 
                Editar(true);
                Limpiar();
                txRut.requestFocus();
             
                btGuardar.setEnabled(true);
                btCancelar.setEnabled(true);
                btEditar.setEnabled(false);
                btNuevo.setEnabled(false);
                
                break;
                
            
            //Editando    
            case 2: 
                Editar(true);
                Limpiar();
                GrillaMouseClicked(null);
                
                btGuardar.setEnabled(true);
                btCancelar.setEnabled(true);
                btNuevo.setEnabled(false);
                btEditar.setEnabled(false);
                
                break;
                
            //Grabando    
            case 3:
                Editar(false);
                btGuardar.setEnabled(false);
                btCancelar.setEnabled(false);
                btNuevo.setEnabled(true);
                btEditar.setEnabled(true);   
                
                break;
                
            //Cancelar    
            case 4:
                Editar(false);
                
                if (Tipo == 0){
                                
                    Limpiar();
                
                }
                
                btGuardar.setEnabled(false);
                btCancelar.setEnabled(false);
                btNuevo.setEnabled(true);
                btEditar.setEnabled(true);  
                
                Grilla.changeSelection(0, 1, false, false );
                GrillaCostos.changeSelection(0, 1, false, false );
                
                break;
                
        }
    }
    
    private void Editar(boolean Estado){
        
        txUsuario.setEditable(Estado);
        txPassword.setEditable(Estado);
        
        txRut.setEditable(Estado);
        txNombre.setEditable(Estado);
        txPaterno.setEditable(Estado);
        txMaterno.setEditable(Estado);
        txNivel.setEditable(Estado);
        cbGrupo.setEditable(Estado);
        cbGrupo.setEnabled(Estado);
        
        chkCajero.setEnabled(Estado);
        
        if (Estado){
        
            if (chkCajero.isSelected()){
            
                rbPLC.setEnabled(Estado);
                rbHRF.setEnabled(Estado);
                rbSinSALA.setEnabled(Estado);
            }
        
        }else {
        
           rbPLC.setEnabled(false);
           rbHRF.setEnabled(false);
           rbSinSALA.setEnabled(false); 
        
        }
       
        
    }
    private void Limpiar(){
        txRut.setText("");
        txPaterno.setText("");
        txUsuario.setText("");
        txNombre.setText("");
        txMaterno.setText("");
        txPassword.setSize(100, 20);
        txPassword.setText("");
        txNivel.setText("");
        
        ch_administrador.setSelected(false);
        ch_ventaempresa.setSelected(false);
        ch_eligeUbc.setSelected(false);
        ch_adminocp.setSelected(false);
        ch_ajuste.setSelected(false);
        ch_cobranza.setSelected(false);
        ch_gastos.setSelected(false);
        ch_transformacion.setSelected(false);
        
        ch_ventaempresa.setSelected(false);
        ch_eligeUbc.setSelected(false);
        ch_auditoria.setSelected(false);
        ch_asoc_vendedor.setSelected(false);
        ch_separa_despacha.setSelected(false);
        ch_recepcion.setSelected(false);
        ch_configuracion.setSelected(false);
        ch_asigna_separacion.setSelected(false);
        ch_autoriza_separacion.setSelected(false);
        ch_asoc_proveedor.setSelected(false);
        
        
    }
    
    private void CargaUsuarios(){
        ExeSql Sql = new ExeSql();
        ResultSet Rs;
        DefaultTableModel dfTm = (DefaultTableModel) Grilla.getModel();
        
        //Limpiar();
        
        fmMain.LimpiaGrilla(dfTm);
        try {
             Rs = Sql.Select(" select p.usesysid, p.usename, u.usuario, u.id, case when u.separador is NULL then 0 else  u.separador end from pg_user p \n" +
                             " left join usuario u on lower(u.usuario) = p.usename \n" +
                             " left join personal pr on u.usuario = pr.usuario \n" +
                             " where usename <> 'postgres' and pr.activo is true order by p.usename");

            
            while(Rs.next()){
               dfTm.addRow(new Object[]{Rs.getString("usesysid"),Rs.getString("usename"), Rs.getInt("id")});
            }
                
        } catch (Exception e) {
        }
    }
    
    private void CargaCCostos(){
        ExeSql Sql = new ExeSql();
        ResultSet Rs;
        DefaultTableModel dfTm = (DefaultTableModel) GrillaCostos.getModel();  
        
        Limpiar();
        try {
            Rs = Sql.Select(" SELECT * FROM pccostos");
            while(Rs.next()){
                dfTm.addRow(new Object[]{Rs.getString("id"),Rs.getString("nombre")});
            }
                
        } catch (Exception e) {
        }
    }        
    
    private void btNuevoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btNuevoActionPerformed
        Tipo = 0;
        SetTipo(1);        
    }//GEN-LAST:event_btNuevoActionPerformed

    private void btGuardarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btGuardarActionPerformed
        ExeSql Sql = new ExeSql();
        ExeSql Sql2 = new ExeSql();
        String Query ="";
        String Query2 ="";
        ResultSet Rs;
        int separador = 0;
       
               
        if(txNombre.getText().isEmpty() || txUsuario.getText().isEmpty() || txRut.getText().isEmpty())
        {
            fmMain.Mensaje("Faltan valores por Ingresar Nombre o Usuario o Password o Rut.");
            return;
            
        }
        
        if ( txPassword.getText().isEmpty() ) {
            fmMain.Mensaje("Si la Password esta vacia se mantendrá la clave actual.");
        }
        
        
        int Sala = 0;
        
        if (chkCajero.isSelected()){
            
            if (rbSinSALA.isSelected()){
            
                fmMain.Mensaje("Debe elegir una SALA..!");
                return;
            
            }
            
            
            if (rbPLC.isSelected()){
            
               Sala = 1;
            
            }else if (rbHRF.isSelected()){
            
                Sala = 2;
            
            
            }
            
            
            
            
            RolSala = 1;
                
        }else {       
                    
            RolSala = 0; 
            Sala = 0;
                
        }
        
        
        
        
        
        
      
        try {
            
            Query = "select usename usuario,passwd from pg_user where usename='" + txUsuario.getText().toLowerCase()+"';";
            Rs = Sql.Select(Query);
            
           
            if (Rs.next()) {   // Si existe el usuario se actualizan todos los datos
                
                // Actualiza usuario de la tabla pg_user.
                txUsuario.setText(Rs.getString("usuario").trim());  

                if  ( txPassword.getText().isEmpty())  { 
               
                
                }else{   
                
                    Query ="alter user "+ txUsuario.getText().toLowerCase().trim() +" with password '"+ txPassword.getText().trim() +"'";
                    Sql.ExeSql(Query);
                    Sql.Commit();
                }               
                
                if (txNivel.getText().trim()  == ""){
                
                    txNivel.setText("0");
                }
                       
                if (chkSeparador.isSelected()){
                            
                    separador = 1;    
            
                }
                       
                Query = "update usuario set nombre = '" + txNombre.getText().trim() + " " + txPaterno.getText().trim() + "', \n" +
                        "nivel = " + txNivel.getText().trim() + ", \n"+
                        "activo = "+esactivo.isSelected() +  ", \n"+
                        "separador = "+ separador + " \n"+
                        "where id  = " + Grilla.getModel().getValueAt(Grilla.getSelectedRow(),2).toString() ;
                         
                            
                Sql.ExeSql(Query);
                Sql.Commit();        
                        
                // Actualiza la tabla personal_ccostos 
                Query = "update personal_ccostos2 set ccosto = " + GrillaCostos.getModel().getValueAt(GrillaCostos.getSelectedRow(),0).toString() +  "\n" +
                        "where rut =" + txRut.getText().trim();

                Sql.ExeSql(Query);
                Sql.Commit();
                                                
                Query2 = "update personal_ccostos set ccosto = " + GrillaCostos.getModel().getValueAt(GrillaCostos.getSelectedRow(),0).toString() +  "\n" +
                         "where rut =" + txRut.getText().trim();

                Sql2.ExeSql(Query2);
                Sql2.Commit();
                        
                     
                // Actualiza la tabla personal
                
                boolean activo = false;
                
                
                
                if (esactivo.isSelected()){
                
                    activo = true; 
                
                }else {
                
                    activo = false;
                
                }
                
                
                Query = "update personal set nombre = '" +  txNombre.getText().trim() + "', apellidopaterno = '" + txPaterno.getText().trim() + "', \n"+
                        "apellidomaterno = '"  + txMaterno.getText().trim() + "', \n"+
                        "cajaautoriza = "+RolSala + ", \n"+
                        "activo = "+activo + ", \n"+
                        "sala = "+Sala + " \n"+
                        "where rut =" + txRut.getText().trim();
                        
                Sql.ExeSql(Query);
                Sql.Commit();
                        
                
                Query = "update pacceso set \n"+
                        "administrador = '" + ch_administrador.isSelected() + "', \n"+
                        "ajuste = '" + ch_ajuste.isSelected() + "', \n"+
                        "cobranza = '"  + ch_cobranza.isSelected() + "', \n" + 
                        "transformacion = '" +  ch_transformacion.isSelected() + "', \n"+
                        "gastos = '"  + ch_gastos.isSelected() + "', \n"+
                        "adminocp = '" + ch_adminocp.isSelected() + "', \n"+
                        "bodega = '"  + ch_bodega.isSelected() + "', \n" +
                        "admin_ventaempresa = '" + ch_ventaempresa.isSelected() + "', \n"+
                        "elige_ubica = '" + ch_eligeUbc.isSelected() + "', \n"+
                        "admin_auditoria = '" + ch_auditoria.isSelected() +"', \n"+
                        "admin_asocvendedor = '"+ch_asoc_vendedor.isSelected()+"', \n"+
                        "admin_separadespacha ='"+ch_separa_despacha.isSelected()+"', \n"+
                        "admin_recepcion ='"+ch_recepcion.isSelected()+"',\n"+
                        "configuracion ='"+ch_asoc_proveedor.isSelected()+"', \n"+
                        "admin_asociaprov ='"+ch_configuracion.isSelected()+"', \n"+
                        "admin_asignasepara ='"+ch_asigna_separacion.isSelected()+"', \n"+
                        "admin_autorizasepara ='"+ch_autoriza_separacion.isSelected()+"', \n"+
                        "admin_autoriza_ocp ='"+ch_autoriza_ocp.isSelected()+"', \n"+
                        "admin_edita_ocp ='"+ch_edita_ocp.isSelected()+"', \n"+
                        "admin_edita_nomsku ='"+ch_edita_nom_sku.isSelected()+"' \n"+
                        "where rut =" + txRut.getText().trim();
               
                
                Sql.ExeSql(Query);
                Sql.Commit();        
                
                CargaUsuarios();
               
                fmMain.Mensaje("Usuario Modificado Éxitosamente" );
                Rs.close();
                SetTipo(3);  
           
                chkSeparador.setEnabled(false);
            
            }else{   //Se crea el usuario nuevo
                  
                            
                Query = "CREATE USER " + txUsuario.getText().trim() + " PASSWORD '" + txPassword.getText() + "';\n" +
                        "ALTER ROLE " + txUsuario.getText().toLowerCase().trim() + " WITH SUPERUSER;\n";
      
                Sql.ExeSql(Query);
                Sql.Commit();
                       
                // lo crea en tabla usuario
                Query = "INSERT INTO USUARIO \n" +
                                        " (\n" +
                                        "usuario,\n" +
                                        "nombre,\n" +
                                        "nivel,\n" +
                                        "ajuste,\n" +
                                        "cobranza,\n" +
                                        "transformacion,\n" +
                                        "admin_ocp)\n" +
                                        "VALUES('" + txUsuario.getText().trim() + "','" + txNombre.getText().trim() + " " + txPaterno.getText().trim() + "'," + 
                                                     txNivel.getText().trim() + ",0,0,0,0)";
                
                
                
                Sql.ExeSql(Query);
                Sql.Commit();
                        
                // Se Asigna a la tabla Centro de Costos
                Query = "INSERT INTO personal_ccostos2(rut,ccosto) \n" +
                        "VALUES(" + txRut.getText().trim() + ","+ GrillaCostos.getModel().getValueAt(GrillaCostos.getSelectedRow(),0).toString() +  ");";

                Sql.ExeSql(Query);
                Sql.Commit();
                
                
                 // Se Asigna a la tabla Centro de Costos
                String Query3 = "INSERT INTO personal_ccostos(rut,ccosto) \n" +
                        "VALUES(" + txRut.getText().trim() + ","+ GrillaCostos.getModel().getValueAt(GrillaCostos.getSelectedRow(),0).toString() +  ");";

                Sql.ExeSql(Query3);
                Sql.Commit();
                  
                boolean activo = false;
                
                
                if (esactivo.isSelected()){
                
                    activo = true; 
                
                }else {
                
                    activo = false;  
                
                }
                
                
                        
                // Ingresa los datos en la tabla personal
//                Query="insert into personal(rut, nombre, usuario, vendedor, apellidopaterno,\n" +
//                      "apellidomaterno, direccion, poblacion, ciudad, celular, empresa,cajaautoriza,activo,sala)\n" +
//                      "values (" +  txRut.getText().trim() +" , '" + txNombre.getText().trim() + " ','" + txUsuario.getText().trim() + "', \n"+
//                      "NULL, '" + txPaterno.getText().trim() + "','" + txMaterno.getText().trim() + "',\n" +
//                      " '', '', '', '',1,"+RolSala+","+activo+","+Sala+")";
                
                Query="insert into personal(rut, nombre, usuario, vendedor, apellidopaterno,\n" +
                      "apellidomaterno, direccion, poblacion, ciudad, celular, empresa,cajaautoriza,activo,sala)\n" +
                      "values (" +  txRut.getText().trim() +" , '" + txNombre.getText().trim() + " ','" + txUsuario.getText().trim() + "', \n"+
                      txCodVend.getText().trim()+ ",'" + txPaterno.getText().trim() + "','" + txMaterno.getText().trim() + "',\n" +
                      " '', '', '', '',1,"+RolSala+","+activo+","+Sala+")";
                
                
                        
                Sql.ExeSql(Query);
                Sql.Commit();
                         
                
                
                Query = "insert into pacceso( \n" +
                        "rut,\n" +
                        "administrador,\n" +
                        "ajuste,\n" +
                        "transformacion,\n" +
                        "cobranza,\n" +
                        "gastos,\n" +
                        "bodega,\n" +
                        "adminocp, admin_ventaempresa,elige_ubica,admin_auditoria,admin_asocvendedor,admin_separadespacha,admin_recepcion,configuracion, \n"+
                        "admin_asignasepara,admin_autorizasepara, admin_asociaprov,admin_autoriza_ocp, admin_edita_ocp, admin_edita_nomsku)\n" +
                        "VALUES("+ txRut.getText().trim()  + ",'" + ch_administrador.isSelected() + "','"
                                 + ch_ajuste.isSelected() + "','" + ch_transformacion.isSelected() + "','"
                                 + ch_cobranza.isSelected() + "','" + ch_gastos.isSelected() + "','"
                                 + ch_bodega.isSelected() + "','"
                                 + ch_adminocp.isSelected() + "','"
                                 + ch_ventaempresa.isSelected() + "','"
                                 + ch_eligeUbc.isSelected() +  "','"
                                 + ch_auditoria.isSelected() + "','"
                                 + ch_asoc_vendedor.isSelected() + "','"
                                 + ch_separa_despacha.isSelected() + "','"
                                 + ch_recepcion.isSelected() + "','"
                                 + ch_configuracion.isSelected() + "','"
                                 + ch_asigna_separacion.isSelected() + "','"
                                 + ch_autoriza_separacion.isSelected() + "','"
                                 + ch_asoc_proveedor.isSelected() + "','"
                                 + ch_autoriza_ocp.isSelected() + "','"
                                 + ch_edita_ocp.isSelected() + "','"
                                 + ch_edita_nom_sku.isSelected() + "')";  
                
                Sql.ExeSql(Query);
                Sql.Commit();
 
                SetTipo(3);  
                
                CargaUsuarios();
                fmMain.Mensaje("El usuario ha sido Creado Correctamente");
                
                chkSeparador.setEnabled(false);
                
            }
            
            
            
     
        } catch (SQLException e) {
            JOptionPane.showMessageDialog(null, e);
            Logger.getLogger(pfUsuarios.class.getName()).log(Level.SEVERE, null, e);
            Sql.Rollback();
            Sql2.Rollback();
        }
        finally {
            Sql.Close();
            Sql2.Close();
        }
        
    }//GEN-LAST:event_btGuardarActionPerformed

    private void txUsuarioKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txUsuarioKeyReleased
        txUsuario.setText(txUsuario.getText().toUpperCase());
    }//GEN-LAST:event_txUsuarioKeyReleased

    private void txNombreKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txNombreKeyReleased
        txNombre.setText(txNombre.getText().toUpperCase());
    }//GEN-LAST:event_txNombreKeyReleased

    private void GrillaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_GrillaMouseClicked
        
        ExeSql Sql = new ExeSql();
        ExeSql Sql3 = new ExeSql();
        ResultSet Rs,Rs1, Rs3;
        String Query ="";
        String Query2 ="";
        String Query3 ="";
        
    
        btEditar.setEnabled(true);
        btEliminar.setEnabled(true);
        
        Limpiar();
        Query = "select usesysid, usename usuario,passwd from pg_user where usesysid=" + Grilla.getModel().getValueAt(Grilla.getSelectedRow(),0).toString() +";";
        try {
            
            Rs = Sql.Select(Query);
            
            if (Rs.next()) {
                    
                txUsuario.setText(Rs.getString("usuario").trim());
                txPassword.setText("");
                Rs.close();
            }
            
 
            // Ahora buscamos el nombre de usuario
                
            Query2 ="SELECT p.rut, p.nombre,p.usuario,p.apellidopaterno paterno,p.apellidomaterno materno, \n"+
                    "case when p.vendedor is null then 0 else p.vendedor end as vend,\n" +
                    "a.administrador administrador_acc,a.ajuste ajuste_acc ,a.cobranza cobranza_acc,\n" +
                    "a.gastos gastos_acc ,a.transformacion transformacion_acc, a.bodega, a.admin_ventaempresa, a.elige_ubica, a.admin_auditoria,a.admin_asocvendedor, \n" +
                    "a.admin_separadespacha, a.admin_recepcion, a.configuracion, a.admin_asignasepara,a.admin_autorizasepara, a.admin_asociaprov, \n"+
                    "a.adminocp adminocp_acc,admin_autoriza_ocp,admin_edita_ocp,admin_edita_nomsku, cc.ccosto ccosto_pcc,p.rut rut_pers, u.nivel, p.activo, u.separador, p.cajaautoriza, p.sala \n" +
                    "from personal p \n" +
                    "left join pacceso a on p.rut=a.rut \n" +
                    "left join personal_ccostos cc on p.rut=cc.rut \n" +
                    "left join usuario u on u.usuario = p.usuario \n" +
                    "WHERE u.usuario ='" + txUsuario.getText().toUpperCase().trim() + "'"; 
            
            Rs1 = Sql.Select(Query2);
            
            if (Rs1.next()) {
                txNombre.setText(Rs1.getString("nombre").toUpperCase().trim());     
                txPaterno.setText(Rs1.getString("paterno").toUpperCase().trim());
                txMaterno.setText(Rs1.getString("materno").toUpperCase().trim());
                txRut.setText(Rs1.getString("rut").toUpperCase().trim());
                txNivel.setText(Rs1.getString("nivel"));
                esactivo.setSelected(Rs1.getBoolean("activo"));
                
                if (Rs1.getInt("vend") == 0){
                
                    txCodVend.setText("NULL");
                
                }else{
                
                    txCodVend.setText(Rs1.getString("vend"));
                }
                
                boolean admin_boo = Rs1.getBoolean("administrador_acc");
                if (admin_boo ){
                       ch_administrador.setSelected(true);
                       ch_administrador.setBackground(Color.green);
                       ch_administrador.setForeground(Color.black);
                } else
                {
                    ch_administrador.setSelected(false);
                    ch_administrador.setBackground(Color.red);
                    ch_administrador.setForeground(Color.white);
                }   
                
                boolean ajuste_boo = Rs1.getBoolean("ajuste_acc");
                if (ajuste_boo ){
                       ch_ajuste.setSelected(true);
                       ch_ajuste.setBackground(Color.green);
                       ch_ajuste.setForeground(Color.black);
                       
                       
                } else
                {
                    ch_ajuste.setSelected(false);
                    ch_ajuste.setBackground(Color.red);
                    ch_ajuste.setForeground(Color.white);
                    
                    
                }   
                 
                boolean cobranza_boo = Rs1.getBoolean("cobranza_acc");
                if (cobranza_boo ){
                       ch_cobranza.setSelected(true);
                       ch_cobranza.setBackground(Color.green);
                       ch_cobranza.setForeground(Color.black);
                       
                       
                } else
                {
                    ch_cobranza.setSelected(false);
                    ch_cobranza.setBackground(Color.red);
                    ch_cobranza.setForeground(Color.white);
                }
                
                
                boolean gastos_boo = Rs1.getBoolean("gastos_acc");
                if (gastos_boo ){
                       ch_gastos.setSelected(true);
                       ch_gastos.setBackground(Color.green);
                       ch_gastos.setForeground(Color.black);
                       
                       
                } else
                {
                    ch_gastos.setSelected(false);
                    ch_gastos.setBackground(Color.red);
                    ch_gastos.setForeground(Color.white);
                    
                    
                }
                
                boolean transformacion_boo = Rs1.getBoolean("transformacion_acc");
                if (transformacion_boo ){
                       ch_transformacion.setSelected(true);
                       ch_transformacion.setBackground(Color.green);
                       ch_transformacion.setForeground(Color.black);
                       
                       
                } else
                {
                    ch_transformacion.setSelected(false);
                    ch_transformacion.setBackground(Color.red);
                    ch_transformacion.setForeground(Color.white);
                    
                }
                
                boolean adminocp_boo = Rs1.getBoolean("adminocp_acc");
                if (adminocp_boo ){
                      ch_adminocp.setSelected(true);
                      ch_adminocp.setBackground(Color.green);
                      ch_adminocp.setForeground(Color.black);
                      
                      
                } else
                {
                    ch_adminocp.setSelected(false);
                    ch_adminocp.setBackground(Color.red);
                    ch_adminocp.setForeground(Color.white);
                    
                }
                
                boolean bodega_boo = Rs1.getBoolean("bodega");
                if (bodega_boo ){
                     ch_bodega.setSelected(true);
                     ch_bodega.setBackground(Color.green);
                     ch_bodega.setForeground(Color.black);
                     
                     
                } else
                {
                    ch_bodega.setSelected(false);
                    ch_bodega.setBackground(Color.red);
                    ch_bodega.setForeground(Color.white);
                    
                    
                }
                
                boolean ventaempresa_boo = Rs1.getBoolean("admin_ventaempresa");
                if (ventaempresa_boo ){
                     ch_ventaempresa.setSelected(true);
                     ch_ventaempresa.setBackground(Color.green);
                     ch_ventaempresa.setForeground(Color.black);
                     
                     
                } else
                {
                    ch_ventaempresa.setSelected(false);
                    ch_ventaempresa.setBackground(Color.red);
                    ch_ventaempresa.setForeground(Color.white);
                    
                    
                }
                
                
                boolean eligeubc_boo = Rs1.getBoolean("elige_ubica");
                if (eligeubc_boo ){
                     ch_eligeUbc.setSelected(true);
                     ch_eligeUbc.setBackground(Color.green);
                     ch_eligeUbc.setForeground(Color.black);
                     
                     
                } else
                {
                    ch_eligeUbc.setSelected(false);
                    ch_eligeUbc.setBackground(Color.red);
                    ch_eligeUbc.setForeground(Color.white);
                    
                }
                
                
                boolean auditoria_boo = Rs1.getBoolean("admin_auditoria");
                if (auditoria_boo ){
                     ch_auditoria.setSelected(true);
                     ch_auditoria.setBackground(Color.green);
                     ch_auditoria.setForeground(Color.black);
                     
                } else
                {
                    ch_auditoria.setSelected(false);
                    ch_auditoria.setBackground(Color.red);
                    ch_auditoria.setForeground(Color.white);
                    
                }
                
                
                
                boolean asociavendedor_boo = Rs1.getBoolean("admin_asocvendedor");
                if (asociavendedor_boo ){
                     ch_asoc_vendedor.setSelected(true);
                     ch_asoc_vendedor.setBackground(Color.green);
                     ch_asoc_vendedor.setForeground(Color.black);
                     
                } else
                {
                    ch_asoc_vendedor.setSelected(false);
                    ch_asoc_vendedor.setBackground(Color.red);
                    ch_asoc_vendedor.setForeground(Color.white);
                    
                }
                
                boolean separadespacha_boo = Rs1.getBoolean("admin_separadespacha");  //Autorizado para Separar y Despachar
                if (separadespacha_boo ){
                     ch_separa_despacha.setSelected(true);
                     ch_separa_despacha.setBackground(Color.green);
                     ch_separa_despacha.setForeground(Color.black);
                     
                     
                } else
                {
                    ch_separa_despacha.setSelected(false);
                    ch_separa_despacha.setBackground(Color.red);
                    ch_separa_despacha.setForeground(Color.white);
                }
                
                
                boolean recepciona_boo = Rs1.getBoolean("admin_recepcion");  //Autorizado para Recepcionar
                if (recepciona_boo ){
                     ch_recepcion.setSelected(true);
                     ch_recepcion.setBackground(Color.green);
                     ch_recepcion.setForeground(Color.black);
                     
                     
                } else
                {
                    ch_recepcion.setSelected(false);
                    ch_recepcion.setBackground(Color.red);
                    ch_recepcion.setForeground(Color.white);
                    
                }
                
                
                boolean config_boo = Rs1.getBoolean("configuracion");  //Autorizado Configurar Usuarios y otros
                if (config_boo ){
                    ch_configuracion.setSelected(true);
                    ch_configuracion.setBackground(Color.green);
                    ch_configuracion.setForeground(Color.black);
                    
                } else
                {
                    ch_configuracion.setSelected(false);
                    ch_configuracion.setBackground(Color.red);
                    ch_configuracion.setForeground(Color.white);
                }
                
                
                boolean asignasepara_boo = Rs1.getBoolean("admin_asignasepara");  //Autorizado para asignar separación
                
                if (asignasepara_boo ){
                    
                    ch_asigna_separacion.setSelected(true);
                    ch_asigna_separacion.setBackground(Color.green);
                    ch_asigna_separacion.setForeground(Color.black);
                     
                     
                } else
                {
                    ch_asigna_separacion.setSelected(false);
                    ch_asigna_separacion.setBackground(Color.red);
                    ch_asigna_separacion.setForeground(Color.white);
                    
                }
                
                
                
                boolean autorizasepara_boo = Rs1.getBoolean("admin_autorizasepara");  //Autorizado para autorizar separación
                
                if (autorizasepara_boo ){
                    
                    ch_autoriza_separacion.setSelected(true);
                    ch_autoriza_separacion.setBackground(Color.green);
                    ch_autoriza_separacion.setForeground(Color.black);
                     
                     
                } else
                {
                    ch_autoriza_separacion.setSelected(false);
                    ch_autoriza_separacion.setBackground(Color.red);
                    ch_autoriza_separacion.setForeground(Color.white);
                    
                }
                
                
                
                
                
                
                boolean asociaproveedor_boo = Rs1.getBoolean("admin_asociaprov");  //Autorizado para asociar codigo de proveedor a sku
                
                if (asociaproveedor_boo ){
                    
                    ch_asoc_proveedor.setSelected(true);
                    ch_asoc_proveedor.setBackground(Color.green);
                    ch_asoc_proveedor.setForeground(Color.black);
                     
                     
                } else
                {
                    ch_asoc_proveedor.setSelected(false);
                    ch_asoc_proveedor.setBackground(Color.red);
                    ch_asoc_proveedor.setForeground(Color.white);
                    
                }
                
                
                
                boolean autorizaocp_boo = Rs1.getBoolean("admin_autoriza_ocp");  //Autorizado para orden de compra proveedor
                
                if (autorizaocp_boo ){
                    
                    ch_autoriza_ocp.setSelected(true);
                    ch_autoriza_ocp.setBackground(Color.green);
                    ch_autoriza_ocp.setForeground(Color.black);
                     
                     
                } else{
                    
                    ch_autoriza_ocp.setSelected(false);
                    ch_autoriza_ocp.setBackground(Color.red);
                    ch_autoriza_ocp.setForeground(Color.white);
                    
                }
                
                boolean editaocp_boo = Rs1.getBoolean("admin_edita_ocp");  //Autorizado para editar orden de compra proveedor completa
                
                if (editaocp_boo ){
                    
                    ch_edita_ocp.setSelected(true);
                    ch_edita_ocp.setBackground(Color.green);
                    ch_edita_ocp.setForeground(Color.black);
                     
                     
                } else{
                    
                    ch_edita_ocp.setSelected(false);
                    ch_edita_ocp.setBackground(Color.red);
                    ch_edita_ocp.setForeground(Color.white);
                    
                }
                
               

                
                boolean editanomsku_boo = Rs1.getBoolean("admin_edita_nomsku");  //Autorizado para editar y modificar nombre de un producto
                
                if (editanomsku_boo ){
                    
                    ch_edita_nom_sku.setSelected(true);
                    ch_edita_nom_sku.setBackground(Color.green);
                    ch_edita_nom_sku.setForeground(Color.black);
                     
                     
                } else{
                    
                    ch_edita_nom_sku.setSelected(false);
                    ch_edita_nom_sku.setBackground(Color.red);
                    ch_edita_nom_sku.setForeground(Color.white);
                    
                }    
                
                


//ch_edita_nom_sku
                
        //*********************************************************************************************************************************************//        
                
                
                
                if (Rs1.getInt("separador") == 1){   //Designado para asignarle Ordenes automaticamente
                
                   chkSeparador.setSelected(true);
                   chkSeparador.setBackground(Color.green);
                   chkSeparador.setForeground(Color.black);
                   lb1.setVisible(true);
                
                
                }else {
                    
                    chkSeparador.setSelected(false);
                    chkSeparador.setBackground(Color.red);
                    chkSeparador.setForeground(Color.white);
                    
                    lb1.setVisible(false);
                    
                
                }
                
                
                
                
                if (Rs1.getInt("sala") == 1){
                
                    rbPLC.setSelected(true);
                    
                }else if (Rs1.getInt("sala") == 2){
                
                    rbHRF.setSelected(true);
                
                }else {
                
                    rbSinSALA.setSelected(true);
                
                }     
                
                
                if (Rs1.getInt("cajaautoriza") == 1){   //Autorizado para trabajar en la Sala de Ventas
                
                   chkCajero.setSelected(true);
                   chkCajero.setBackground(Color.green);
                   chkCajero.setForeground(Color.black);
                   
                }else {
                
                    chkCajero.setSelected(false);
                    chkCajero.setBackground(Color.red);
                    chkCajero.setForeground(Color.white);
                                
                }
                
               
                
                
                
                
    //**************************************************************************************************************************************//            
                
                for(int i = 0; i < GrillaCostos.getRowCount(); i++){
                    if(GrillaCostos.getValueAt(i,0).toString().equals(Rs1.getString("ccosto_pcc"))){
                        GrillaCostos.changeSelection(i, 1, false, false);
                        break;
                    }
                }
            
                
                txCcosto.setText(GrillaCostos.getValueAt(GrillaCostos.getSelectedRow(), 0).toString().trim());
                
                txPassword.setText("");
                
                
                Rs1.close();
                Sql.Close();
                
                Tipo = 1;
                
            }
     
        } catch (SQLException e) {
            
             Logger.getLogger(pfUsuarios.class.getName()).log(Level.SEVERE, null, e);
            
            Sql.Close();
                 
            
        }        
    }//GEN-LAST:event_GrillaMouseClicked

    private void btEditarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btEditarActionPerformed
        
        Tipo = 1;
        
        SetTipo(2); 
        
        if (chkSeparador.isSelected()){
        
            
            if (lb1.isVisible()){
            
                chkSeparador.setEnabled(true);
            
            }
        
        }else {
            ExeSql Sql = new ExeSql();
            ResultSet Rs = null;
            
            try {
                Rs = Sql.Select("SELECT usuario FROM usuario WHERE separador = 1 and usuario NOT IN ('"+txUsuario.getText().toUpperCase().trim()+"')");
                
                if (Sql.GetRowCount() > 0){
            
                    chkSeparador.setEnabled(false);
                
                }else{
                
                    chkSeparador.setEnabled(true);
                
                }
                
                
            } catch (SQLException ex) {
                Logger.getLogger(pfUsuarios.class.getName()).log(Level.SEVERE, null, ex);
            }
                           
            
        
        }
        
        
    }//GEN-LAST:event_btEditarActionPerformed

    private void txPaternoKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txPaternoKeyReleased
         txPaterno.setText(txPaterno.getText().toUpperCase());

    }//GEN-LAST:event_txPaternoKeyReleased

    private void txRutKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txRutKeyReleased
        // TODO add your handling code here:
    }//GEN-LAST:event_txRutKeyReleased

    private void GrillaCostosMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_GrillaCostosMouseClicked
        
         if(evt.getClickCount()==1){
         
            if (Tipo == 0 || Tipo == 1){ 
             
                txCcosto.setText(GrillaCostos.getValueAt(GrillaCostos.getSelectedRow(), 0).toString().trim());
                
                if (Tipo == 0){ 
                
                    
                    if (txCcosto.getText().trim().equals("5")){
                    
                        ExeSql Sql = new ExeSql();
                        ResultSet Rs;
                
                        try {
                
                    
                            Rs = Sql.Select("select p.vendedor from personal p\n" +
                                            "where p.vendedor is not null\n" +
                                            "order by p.vendedor desc\n" +
                                            "limit 1 ");
                        
                            Rs.next();
                        
                            int codvend = Rs.getInt("vendedor")+1;
                            
                            txCodVend.setText(""+codvend);
                
                
                        } catch (SQLException ex) {
                            Logger.getLogger(pfUsuarios.class.getName()).log(Level.SEVERE, null, ex);
                        }
                
                    
                    }else{
                    
                        txCodVend.setText("NULL");
                    
                    }
            
                }
             
             
            } 
         
            
            
         }
        
    }//GEN-LAST:event_GrillaCostosMouseClicked

    private void txMaternoKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txMaternoKeyReleased
                txMaterno.setText(txMaterno.getText().toUpperCase());
    }//GEN-LAST:event_txMaternoKeyReleased

    private void ch_cobranzaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ch_cobranzaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ch_cobranzaActionPerformed

    private void txPasswordActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txPasswordActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txPasswordActionPerformed

    private void btEliminarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btEliminarActionPerformed
        // Eliminar los datos relacionados a un usuario
      ExeSql Sql = new ExeSql();
      
      String Query ="";    
      
      try{
          
                      
        if(txUsuario.getText().isEmpty() ||  txRut.getText().isEmpty())
        {
            fmMain.Mensaje("Faltan valores por Ingresar Usuario o Rut."); 
            return;
        } 
          
        Query = "delete from pacceso  where rut = " + txRut.getText() + ";";
        Sql.ExeSql(Query);
      
        Query = "delete from personal_ccostos where rut = " + txRut.getText().trim() + ";";
        Sql.ExeSql(Query);

        Query = "delete from personal where rut =" + txRut.getText().trim() + ";";
        Sql.ExeSql(Query);

        // delete usuario
        Query = "delete from usuario where usuario = '" + txUsuario.getText().toUpperCase() + "';";
        Sql.ExeSql(Query);

        Query = "drop user " + txUsuario.getText().toLowerCase() + ";";
        Sql.ExeSql(Query);
        Sql.Commit();
        CargaUsuarios();
        
        fmMain.Mensaje("Usuario Eliminado del Sistema.");
        } catch (Exception e) {
                 Sql.Close();
        }        
        
        
    }//GEN-LAST:event_btEliminarActionPerformed

    private void txNombreActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txNombreActionPerformed
        // TODO add your handling code here:   //   
    }//GEN-LAST:event_txNombreActionPerformed

    private void txPaternoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txPaternoActionPerformed
        // TODO add your handling code here: 
    }//GEN-LAST:event_txPaternoActionPerformed

    private void btCancelarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btCancelarActionPerformed
        
        SetTipo(4);  // Deja todo con las opciones de  nuevo
        
        chkSeparador.setEnabled(false);
        
         CargaUsuarios();
        
    }//GEN-LAST:event_btCancelarActionPerformed

    private void txNivelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txNivelActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txNivelActionPerformed

    private void GrillaMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_GrillaMousePressed
//      if (evt.getClickCount() > 1) {
//        Point point = evt.getPoint();
//        int row = Grilla.rowAtPoint(point);
//        int column = Grilla.columnAtPoint(point);
//        DefaultTableModel model = (DefaultTableModel) Grilla.getModel();
//       JOptionPane.showMessageDialog(this, model.getValueAt(row, column));
//    }
    }//GEN-LAST:event_GrillaMousePressed

    private void chkSeparadorMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_chkSeparadorMouseClicked
        
        
        if (!chkSeparador.isSelected()){
        
            lb1.setVisible(false);
        
        }
        
        lb1.setVisible(false);
        
    }//GEN-LAST:event_chkSeparadorMouseClicked

    private void chkCajeroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkCajeroActionPerformed
        
        if (chkCajero.isSelected()){
            
            rbPLC.setEnabled(true);
            rbHRF.setEnabled(true);
            rbSinSALA.setEnabled(true);
            
        }else {
        
            rbSinSALA.setSelected(true);
            
            rbPLC.setEnabled(false);
            rbHRF.setEnabled(false);
            rbSinSALA.setEnabled(false);
        
        }
        
        
                
                
    }//GEN-LAST:event_chkCajeroActionPerformed

    private void ch_separa_despachaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ch_separa_despachaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ch_separa_despachaActionPerformed

    private void ch_recepcionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ch_recepcionActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ch_recepcionActionPerformed

    private void ch_configuracionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ch_configuracionActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ch_configuracionActionPerformed

    private void ch_asigna_separacionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ch_asigna_separacionActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ch_asigna_separacionActionPerformed

    private void ch_autoriza_separacionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ch_autoriza_separacionActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ch_autoriza_separacionActionPerformed

    private void ch_autoriza_ocpActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ch_autoriza_ocpActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ch_autoriza_ocpActionPerformed

    private void ch_edita_ocpActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ch_edita_ocpActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ch_edita_ocpActionPerformed

    private void ch_edita_nom_skuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ch_edita_nom_skuActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ch_edita_nom_skuActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTable Grilla;
    private javax.swing.JTable GrillaCostos;
    private javax.swing.JButton btCancelar;
    private javax.swing.JButton btEditar;
    private javax.swing.JButton btEliminar;
    private javax.swing.JButton btGuardar;
    private javax.swing.JButton btNuevo;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.ButtonGroup buttonGroup2;
    private javax.swing.JComboBox cbGrupo;
    private javax.swing.JCheckBox ch_administrador;
    private javax.swing.JCheckBox ch_adminocp;
    private javax.swing.JCheckBox ch_ajuste;
    private javax.swing.JCheckBox ch_asigna_separacion;
    private javax.swing.JCheckBox ch_asoc_proveedor;
    private javax.swing.JCheckBox ch_asoc_vendedor;
    private javax.swing.JCheckBox ch_auditoria;
    private javax.swing.JCheckBox ch_autoriza_ocp;
    private javax.swing.JCheckBox ch_autoriza_separacion;
    private javax.swing.JCheckBox ch_bodega;
    private javax.swing.JCheckBox ch_cobranza;
    private javax.swing.JCheckBox ch_configuracion;
    private javax.swing.JCheckBox ch_edita_nom_sku;
    private javax.swing.JCheckBox ch_edita_ocp;
    private javax.swing.JCheckBox ch_eligeUbc;
    private javax.swing.JCheckBox ch_gastos;
    private javax.swing.JCheckBox ch_recepcion;
    private javax.swing.JCheckBox ch_separa_despacha;
    private javax.swing.JCheckBox ch_transformacion;
    private javax.swing.JCheckBox ch_ventaempresa;
    private javax.swing.JCheckBox chkCajero;
    private javax.swing.JCheckBox chkSeparador;
    private javax.swing.JCheckBox esactivo;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JLabel lb1;
    private javax.swing.JLabel lbCodVend;
    private javax.swing.JPanel pnMenu;
    private javax.swing.JRadioButton rbHRF;
    private javax.swing.JRadioButton rbPLC;
    private javax.swing.JRadioButton rbSinSALA;
    private javax.swing.JTextField txCcosto;
    private javax.swing.JTextField txCodVend;
    private javax.swing.JTextField txMaterno;
    private javax.swing.JTextField txNivel;
    private javax.swing.JTextField txNombre;
    private javax.swing.JPasswordField txPassword;
    private javax.swing.JTextField txPaterno;
    private javax.swing.JTextField txRut;
    private javax.swing.JTextField txUsuario;
    // End of variables declaration//GEN-END:variables
}
